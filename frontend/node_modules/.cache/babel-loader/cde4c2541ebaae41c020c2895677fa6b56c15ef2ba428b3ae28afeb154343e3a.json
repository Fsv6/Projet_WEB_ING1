{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"level-container\"\n};\nconst _hoisted_2 = {\n  class: \"progress-bar\"\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  key: 1\n};\nconst _hoisted_5 = {\n  key: 2,\n  class: \"notice\"\n};\nconst _hoisted_6 = [\"disabled\"];\nconst _hoisted_7 = {\n  class: \"levels-info\"\n};\nconst _hoisted_8 = {\n  key: 0\n};\nconst _hoisted_9 = {\n  key: 1\n};\nconst _hoisted_10 = {\n  key: 2\n};\nconst _hoisted_11 = {\n  key: 3\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"AppLayout\"], null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"üåü Progression de ton niveau\", -1 /* HOISTED */)), _createElementVNode(\"p\", null, [_cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"Niveau actuel :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.currentLevel), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"Points :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.currentPoints), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", {\n      class: \"progress-fill\",\n      style: _normalizeStyle({\n        width: $setup.nextLevel ? Math.min($setup.currentPoints, $setup.pointsNeeded) / $setup.pointsNeeded * 100 + '%' : '100%'\n      })\n    }, null, 4 /* STYLE */)]), $setup.nextLevel ? (_openBlock(), _createElementBlock(\"p\", _hoisted_3, [_createElementVNode(\"em\", null, \"Prochain niveau : \" + _toDisplayString($setup.nextLevel) + \" (\" + _toDisplayString($setup.pointsNeeded) + \" pts)\", 1 /* TEXT */)])) : (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _cache[2] || (_cache[2] = [_createElementVNode(\"em\", null, \"‚ú® Niveau maximum atteint !\", -1 /* HOISTED */)]))), $setup.isVisiteur ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, \" üîí Cr√©e un compte pour d√©bloquer la progression, gagner des points et monter en niveau ! \")) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n      disabled: !$setup.readyForUpgrade,\n      onClick: $setup.upgradeLevel\n    }, \" Monter au niveau suivant \", 8 /* PROPS */, _hoisted_6), _createElementVNode(\"div\", _hoisted_7, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList($setup.niveaux, niveau => {\n      return _createElementVNode(\"div\", {\n        class: \"level-card\",\n        key: niveau\n      }, [_createElementVNode(\"h3\", null, _toDisplayString(niveau.charAt(0).toUpperCase() + niveau.slice(1)), 1 /* TEXT */), _createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Points requis :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.seuils[niveau] || 0), 1 /* TEXT */)]), _createElementVNode(\"ul\", null, [niveau === 'd√©butant' ? (_openBlock(), _createElementBlock(\"li\", _hoisted_8, \"üîì Acc√®s aux objets connect√©s en lecture seule\")) : _createCommentVNode(\"v-if\", true), niveau === 'interm√©diaire' ? (_openBlock(), _createElementBlock(\"li\", _hoisted_9, \"üß≠ Consultation d√©taill√©e des services\")) : _createCommentVNode(\"v-if\", true), niveau === 'avanc√©' ? (_openBlock(), _createElementBlock(\"li\", _hoisted_10, \"‚öôÔ∏è Contr√¥le des objets (on/off, r√©glages)\")) : _createCommentVNode(\"v-if\", true), niveau === 'expert' ? (_openBlock(), _createElementBlock(\"li\", _hoisted_11, \"üõ†Ô∏è Acc√®s √† la gestion et personnalisation des objets/services\")) : _createCommentVNode(\"v-if\", true)])]);\n    }), 64 /* STABLE_FRAGMENT */))])])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","key","_createBlock","$setup","default","_withCtx","_createElementVNode","_hoisted_1","_createTextVNode","_toDisplayString","currentLevel","currentPoints","_hoisted_2","style","_normalizeStyle","width","nextLevel","Math","min","pointsNeeded","_createElementBlock","_hoisted_3","_hoisted_4","_cache","isVisiteur","_hoisted_5","_createCommentVNode","disabled","readyForUpgrade","onClick","upgradeLevel","_hoisted_6","_hoisted_7","_Fragment","_renderList","niveaux","niveau","charAt","toUpperCase","slice","seuils","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_"],"sources":["C:\\Users\\benab\\Desktop\\COURS 24_25\\S2\\WEB\\V4\\Projet_WEB_ING1\\frontend\\src\\views\\LevelView.vue"],"sourcesContent":["<script setup>\r\nimport { computed } from 'vue'\r\nimport { useAuthStore } from '@/stores/auth'\r\nimport api from '@/services/api'\r\nimport AppLayout from '@/layout/AppLayoutGlobal.vue'\r\n\r\nconst auth = useAuthStore()\r\n\r\nconst isVisiteur = computed(() => auth.role === 'visiteur')\r\n\r\nconst niveaux = ['d√©butant', 'interm√©diaire', 'avanc√©', 'expert']\r\nconst seuils = {\r\n  'interm√©diaire': 3,\r\n  'avanc√©': 5,\r\n  'expert': 7\r\n}\r\n\r\nconst currentPoints = computed(() => isVisiteur.value ? 0 : auth.points)\r\nconst currentLevel = computed(() => isVisiteur.value ? 'd√©butant' : auth.niveau)\r\nconst currentIndex = computed(() => niveaux.indexOf(currentLevel.value))\r\n\r\nconst nextLevel = computed(() => niveaux[currentIndex.value + 1])\r\nconst pointsNeeded = computed(() => seuils[nextLevel.value] || null)\r\nconst readyForUpgrade = computed(() =>\r\n    !isVisiteur.value &&\r\n    nextLevel.value &&\r\n    pointsNeeded.value &&\r\n    currentPoints.value >= pointsNeeded.value\r\n)\r\n\r\nconst upgradeLevel = async () => {\r\n  console.log('üü¢ Click d√©tect√© ‚Äì tentative de mont√©e de niveau');\r\n  console.log('auth.userId =', auth.userId);\r\n\r\n  if (!readyForUpgrade.value || !nextLevel.value) return\r\n  try {\r\n    console.log(`üì§ Envoi POST vers /users/${auth.userId}/upgrade avec niveau = ${nextLevel.value}`);\r\n\r\n    const res = await api.post(`/users/${auth.userId}/upgrade`, { niveau: nextLevel.value })\r\n    console.log('‚úÖ R√©ponse API :', res.data);\r\n\r\n    auth.niveau = res.data.niveau\r\n    auth.role = res.data.role\r\n    localStorage.setItem('niveau', res.data.niveau)\r\n    localStorage.setItem('role', res.data.role)\r\n\r\n    alert(\"üéâ F√©licitations ! Tu es maintenant \" + res.data.niveau)\r\n  } catch (err) {\r\n    alert(\"Erreur : \" + (err.response?.data?.error || 'Impossible de monter de niveau'))\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <AppLayout>\r\n    <div class=\"level-container\">\r\n      <h2>üåü Progression de ton niveau</h2>\r\n\r\n      <p><strong>Niveau actuel :</strong> {{ currentLevel }}</p>\r\n      <p><strong>Points :</strong> {{ currentPoints }}</p>\r\n\r\n      <div class=\"progress-bar\">\r\n        <div\r\n            class=\"progress-fill\"\r\n            :style=\"{ width: nextLevel ? (Math.min(currentPoints, pointsNeeded) / pointsNeeded * 100) + '%' : '100%' }\"\r\n        ></div>\r\n      </div>\r\n      <p v-if=\"nextLevel\"><em>Prochain niveau : {{ nextLevel }} ({{ pointsNeeded }} pts)</em></p>\r\n      <p v-else><em>‚ú® Niveau maximum atteint !</em></p>\r\n      <p v-if=\"isVisiteur\" class=\"notice\">\r\n        üîí Cr√©e un compte pour d√©bloquer la progression, gagner des points et monter en niveau !\r\n      </p>\r\n\r\n\r\n      <button\r\n          :disabled=\"!readyForUpgrade\"\r\n          @click=\"upgradeLevel\"\r\n      >\r\n        Monter au niveau suivant\r\n      </button>\r\n\r\n      <div class=\"levels-info\">\r\n        <div class=\"level-card\" v-for=\"niveau in niveaux\" :key=\"niveau\">\r\n          <h3>{{ niveau.charAt(0).toUpperCase() + niveau.slice(1) }}</h3>\r\n          <p><strong>Points requis :</strong> {{ seuils[niveau] || 0 }}</p>\r\n          <ul>\r\n            <li v-if=\"niveau === 'd√©butant'\">üîì Acc√®s aux objets connect√©s en lecture seule</li>\r\n            <li v-if=\"niveau === 'interm√©diaire'\">üß≠ Consultation d√©taill√©e des services</li>\r\n            <li v-if=\"niveau === 'avanc√©'\">‚öôÔ∏è Contr√¥le des objets (on/off, r√©glages)</li>\r\n            <li v-if=\"niveau === 'expert'\">üõ†Ô∏è Acc√®s √† la gestion et personnalisation des objets/services</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </AppLayout>\r\n</template>\r\n\r\n\r\n<style scoped>\r\n.level-container {\r\n  padding: 2rem;\r\n}\r\n.progress-bar {\r\n  height: 20px;\r\n  width: 100%;\r\n  background-color: #eee;\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n  margin: 1rem 0;\r\n}\r\n.progress-fill {\r\n  height: 100%;\r\n  background-color: #2c3e50;\r\n  transition: width 0.5s ease;\r\n}\r\nbutton.btn {\r\n  background-color: #2c3e50;\r\n  color: white;\r\n  padding: 0.5rem 1rem;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\nbutton.btn:disabled {\r\n  background-color: #ccc;\r\n  cursor: not-allowed;\r\n}\r\n.notice {\r\n  color: #666;\r\n  font-style: italic;\r\n  margin-bottom: 1rem;\r\n}\r\n.levels-info {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 1rem;\r\n  margin-top: 2rem;\r\n}\r\n.level-card {\r\n  flex: 1 1 200px;\r\n  background: #f3f3f3;\r\n  border-radius: 10px;\r\n  padding: 1rem;\r\n  box-shadow: 0 0 4px rgba(0, 0, 0, 0.1);\r\n}\r\n.level-card h3 {\r\n  margin-bottom: 0.5rem;\r\n  text-transform: capitalize;\r\n}\r\n.level-card ul {\r\n  padding-left: 1rem;\r\n}\r\n\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}