{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, onMounted } from 'vue';\nimport api from '@/services/api';\nimport AppLayout from '@/layout/AppLayoutGlobal.vue';\nexport default {\n  __name: 'ObjectsManagementView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const objets = ref([]);\n    const showForm = ref(false);\n    const modesInput = ref('');\n    const form = ref({\n      nom: '',\n      description: '',\n      type: '',\n      marque: '',\n      connectivite: 'Wi-Fi',\n      statut: 'Actif',\n      niveauDanger: 'faible',\n      supporteTemperature: false,\n      supporteMode: false\n    });\n    onMounted(async () => {\n      await fetchObjects();\n    });\n    const fetchObjects = async () => {\n      try {\n        const res = await api.get('/objets');\n        objets.value = res.data;\n      } catch (error) {\n        console.error(\"Erreur chargement objets:\", error);\n      }\n    };\n    const createObject = async () => {\n      try {\n        const cleanedModes = modesInput.value.split(',').map(m => m.trim()).filter(Boolean);\n        const payload = {\n          ...form.value,\n          // Forcer des champs m√™me s'ils sont \"vides\"\n          statut: 'Inactif',\n          temperatureCible: form.value.supporteTemperature ? form.value.temperatureCible || 0 : 0,\n          supporteMode: form.value.supporteMode,\n          mode: form.value.supporteMode ? form.value.mode || cleanedModes[0] || null : null,\n          modesDisponibles: form.value.supporteMode ? cleanedModes : []\n        };\n        await api.post('/objets', payload);\n        alert('‚úÖ Objet ajout√© avec succ√®s');\n        showForm.value = false;\n        await fetchObjects();\n      } catch (err) {\n        console.error('Erreur cr√©ation objet :', err);\n        alert('‚ùå Erreur lors de la cr√©ation');\n      }\n    };\n    const requestDeletion = async obj => {\n      try {\n        await api.post(`/objets/${obj._id}/demande-suppression`, {\n          motif: \"Suppression demand√©e par l'utilisateur avanc√©\" // Tu peux rendre ce champ dynamique plus tard\n        });\n        alert(`üîî Demande de suppression envoy√©e pour : ${obj.nom}`);\n      } catch (err) {\n        console.error('‚ùå Erreur envoi suppression :', err);\n        alert(\"Erreur lors de l'envoi de la demande.\");\n      }\n    };\n    const __returned__ = {\n      objets,\n      showForm,\n      modesInput,\n      form,\n      fetchObjects,\n      createObject,\n      requestDeletion,\n      ref,\n      onMounted,\n      get api() {\n        return api;\n      },\n      AppLayout\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","api","AppLayout","objets","showForm","modesInput","form","nom","description","type","marque","connectivite","statut","niveauDanger","supporteTemperature","supporteMode","fetchObjects","res","get","value","data","error","console","createObject","cleanedModes","split","map","m","trim","filter","Boolean","payload","temperatureCible","mode","modesDisponibles","post","alert","err","requestDeletion","obj","_id","motif"],"sources":["C:/Users/benab/Desktop/COURS 24_25/S2/WEB/V4/Projet_WEB_ING1/frontend/src/views/ObjectsManagementView.vue"],"sourcesContent":["<template>\r\n  <AppLayout>\r\n    <div class=\"manage-objects-page\">\r\n      <h1>üõ†Ô∏è Gestion des objets connect√©s</h1>\r\n\r\n      <!-- Bouton pour afficher/masquer le formulaire -->\r\n      <button @click=\"showForm = !showForm\" class=\"btn-toggle\">\r\n        {{ showForm ? 'Annuler' : '‚ûï Ajouter un objet' }}\r\n      </button>\r\n\r\n      <!-- Formulaire d‚Äôajout -->\r\n      <form v-if=\"showForm\" @submit.prevent=\"createObject\" class=\"form-ajout\">\r\n        <div class=\"form-group\">\r\n          <label>Nom</label>\r\n          <input v-model=\"form.nom\" required />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Description</label>\r\n          <textarea v-model=\"form.description\" required></textarea>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Type</label>\r\n          <input v-model=\"form.type\" required />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Marque</label>\r\n          <input v-model=\"form.marque\" />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label>Connectivit√©</label>\r\n          <select v-model=\"form.connectivite\">\r\n            <option value=\"Wi-Fi\">Wi-Fi</option>\r\n            <option value=\"Bluetooth\">Bluetooth</option>\r\n          </select>\r\n        </div>\r\n\r\n\r\n        <div class=\"form-group\">\r\n          <label>Niveau de danger</label>\r\n          <select v-model=\"form.niveauDanger\">\r\n            <option value=\"faible\">Faible</option>\r\n            <option value=\"√©lev√©\">√âlev√©</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"form-group checkbox-group\">\r\n          <label><input type=\"checkbox\" v-model=\"form.supporteTemperature\" /> Supporte la temp√©rature</label>\r\n          <label><input type=\"checkbox\" v-model=\"form.supporteMode\" /> Supporte les modes</label>\r\n        </div>\r\n\r\n        <div class=\"form-group\" v-if=\"form.supporteMode\">\r\n          <label>Modes disponibles (s√©par√©s par virgules)</label>\r\n          <input v-model=\"modesInput\" placeholder=\"Ex: Espresso, Lungo\" />\r\n        </div>\r\n        <div class=\"form-group\" v-if=\"form.supporteMode\">\r\n          <label>Mode par d√©faut</label>\r\n          <input v-model=\"form.mode\" placeholder=\"Ex: Espresso, Auto...\" />\r\n        </div><div class=\"form-group\" v-if=\"form.supporteMode\">\r\n        <label>Modes disponibles (s√©par√©s par virgules)</label>\r\n        <input v-model=\"modesInput\" placeholder=\"Ex: Espresso, Lungo\" />\r\n      </div>\r\n\r\n\r\n\r\n        <button type=\"submit\" class=\"btn-submit\">Cr√©er l'objet</button>\r\n      </form>\r\n\r\n      <!-- Tableau des objets -->\r\n      <table v-if=\"objets.length\" class=\"objects-table\">\r\n        <thead>\r\n        <tr>\r\n          <th>Nom</th>\r\n          <th>Type</th>\r\n          <th>Statut</th>\r\n          <th>Actions</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr v-for=\"obj in objets\" :key=\"obj._id\">\r\n          <td>{{ obj.nom }}</td>\r\n          <td>{{ obj.type }}</td>\r\n          <td>{{ obj.statut }}</td>\r\n          <td>\r\n            <router-link :to=\"`/manage/objects/${obj._id}/edit`\">\r\n              <button class=\"btn-edit\">Modifier</button>\r\n            </router-link>\r\n\r\n            <button @click=\"requestDeletion(obj)\">üóëÔ∏è Solliciter suppression</button>\r\n          </td>\r\n        </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      <p v-else>Aucun objet pour le moment.</p>\r\n    </div>\r\n  </AppLayout>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport api from '@/services/api'\r\nimport AppLayout from '@/layout/AppLayoutGlobal.vue'\r\n\r\nconst objets = ref([])\r\nconst showForm = ref(false)\r\nconst modesInput = ref('')\r\n\r\nconst form = ref({\r\n  nom: '',\r\n  description: '',\r\n  type: '',\r\n  marque: '',\r\n  connectivite: 'Wi-Fi',\r\n  statut: 'Actif',\r\n  niveauDanger: 'faible',\r\n  supporteTemperature: false,\r\n  supporteMode: false\r\n})\r\n\r\nonMounted(async () => {\r\n  await fetchObjects()\r\n})\r\n\r\nconst fetchObjects = async () => {\r\n  try {\r\n    const res = await api.get('/objets')\r\n    objets.value = res.data\r\n  } catch (error) {\r\n    console.error(\"Erreur chargement objets:\", error)\r\n  }\r\n}\r\n\r\nconst createObject = async () => {\r\n  try {\r\n    const cleanedModes = modesInput.value\r\n        .split(',')\r\n        .map(m => m.trim())\r\n        .filter(Boolean);\r\n\r\n    const payload = {\r\n      ...form.value,\r\n\r\n      // Forcer des champs m√™me s'ils sont \"vides\"\r\n      statut: 'Inactif',\r\n      temperatureCible: form.value.supporteTemperature ? form.value.temperatureCible || 0 : 0,\r\n      supporteMode: form.value.supporteMode,\r\n      mode: form.value.supporteMode\r\n          ? form.value.mode || cleanedModes[0] || null\r\n          : null,\r\n      modesDisponibles: form.value.supporteMode ? cleanedModes : []\r\n    };\r\n\r\n    await api.post('/objets', payload);\r\n    alert('‚úÖ Objet ajout√© avec succ√®s');\r\n    showForm.value = false;\r\n    await fetchObjects();\r\n  } catch (err) {\r\n    console.error('Erreur cr√©ation objet :', err);\r\n    alert('‚ùå Erreur lors de la cr√©ation');\r\n  }\r\n};\r\n\r\n\r\nconst requestDeletion = async (obj) => {\r\n  try {\r\n    await api.post(`/objets/${obj._id}/demande-suppression`, {\r\n      motif: \"Suppression demand√©e par l'utilisateur avanc√©\"  // Tu peux rendre ce champ dynamique plus tard\r\n    })\r\n\r\n    alert(`üîî Demande de suppression envoy√©e pour : ${obj.nom}`)\r\n  } catch (err) {\r\n    console.error('‚ùå Erreur envoi suppression :', err)\r\n    alert(\"Erreur lors de l'envoi de la demande.\")\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.manage-objects-page {\r\n  padding: 20px;\r\n}\r\n\r\n.btn-toggle {\r\n  margin-bottom: 20px;\r\n  padding: 8px 14px;\r\n  background-color: #2e8b57;\r\n  color: white;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n\r\n.form-ajout {\r\n  max-width: 600px;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\ninput, textarea, select {\r\n  width: 100%;\r\n  padding: 8px;\r\n  margin-top: 5px;\r\n}\r\n\r\n.checkbox-group label {\r\n  display: block;\r\n  margin-top: 10px;\r\n}\r\n\r\n.btn-submit {\r\n  padding: 10px 20px;\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n\r\n.objects-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-top: 30px;\r\n}\r\n\r\n.objects-table th,\r\n.objects-table td {\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n\r\n.objects-table th {\r\n  background-color: #f5f5f5;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}