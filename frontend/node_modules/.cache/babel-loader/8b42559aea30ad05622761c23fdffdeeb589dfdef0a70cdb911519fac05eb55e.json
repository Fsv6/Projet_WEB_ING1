{"ast":null,"code":"import { onMounted, ref, computed } from 'vue';\nimport { useRoute } from 'vue-router';\nimport api from '@/services/api';\nimport AppLayout from '@/layout/AppLayoutGlobal.vue';\nexport default {\n  __name: 'ControlObjectView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const object = ref(null);\n    const form = ref({\n      temperatureCible: 0,\n      mode: '',\n      statut: 'Actif'\n    });\n\n    // Ces computed doivent être en dehors de onMounted\n    const showTemperature = computed(() => object.value?.supporteTemperature);\n    const showMode = computed(() => object.value?.supporteMode);\n    onMounted(async () => {\n      try {\n        const id = route.params.id;\n        const res = await api.get(`/objets/${id}`);\n        const data = res.data;\n        object.value = {\n          _id: data._id,\n          nom: data.nom,\n          temperatureCible: data.temperatureCible,\n          mode: data.mode,\n          statut: data.statut,\n          supporteTemperature: data.supporteTemperature,\n          supporteMode: data.supporteMode,\n          modesDisponibles: data.modesDisponibles || []\n        };\n        form.value.temperatureCible = object.value.temperatureCible || 0;\n        form.value.mode = object.value.mode || '';\n        form.value.statut = object.value.statut || 'Actif';\n      } catch (error) {\n        console.error('Erreur lors du chargement de l\\'objet:', error);\n      }\n    });\n    const applyChanges = async () => {\n      try {\n        const id = route.params.id;\n        await api.put(`/objets/${id}/control`, {\n          temperatureCible: form.value.temperatureCible,\n          mode: form.value.mode,\n          statut: form.value.statut\n        });\n        alert('✅ Modifications enregistrées avec succès !');\n      } catch (error) {\n        console.error('❌ Erreur API PUT:', error);\n        alert('Erreur lors de la mise à jour de l\\'objet.');\n      }\n    };\n    const __returned__ = {\n      route,\n      object,\n      form,\n      showTemperature,\n      showMode,\n      applyChanges,\n      onMounted,\n      ref,\n      computed,\n      get useRoute() {\n        return useRoute;\n      },\n      get api() {\n        return api;\n      },\n      AppLayout\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","computed","useRoute","api","AppLayout","route","object","form","temperatureCible","mode","statut","showTemperature","value","supporteTemperature","showMode","supporteMode","id","params","res","get","data","_id","nom","modesDisponibles","error","console","applyChanges","put","alert"],"sources":["C:/Users/benab/Desktop/COURS 24_25/S2/WEB/V4/Projet_WEB_ING1/frontend/src/views/ControlObjectView.vue"],"sourcesContent":["<script setup>\r\nimport { onMounted, ref, computed } from 'vue'\r\nimport { useRoute } from 'vue-router'\r\nimport api from '@/services/api'\r\nimport AppLayout from '@/layout/AppLayoutGlobal.vue'\r\n\r\nconst route = useRoute()\r\nconst object = ref(null)\r\nconst form = ref({\r\n  temperatureCible: 0,\r\n  mode: '',\r\n  statut: 'Actif'\r\n})\r\n\r\n// Ces computed doivent être en dehors de onMounted\r\nconst showTemperature = computed(() => object.value?.supporteTemperature)\r\nconst showMode = computed(() => object.value?.supporteMode)\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const id = route.params.id\r\n    const res = await api.get(`/objets/${id}`)\r\n    const data = res.data\r\n\r\n    object.value = {\r\n      _id: data._id,\r\n      nom: data.nom,\r\n      temperatureCible: data.temperatureCible,\r\n      mode: data.mode,\r\n      statut: data.statut,\r\n      supporteTemperature: data.supporteTemperature,\r\n      supporteMode: data.supporteMode,\r\n      modesDisponibles: data.modesDisponibles || []\r\n    }\r\n\r\n    form.value.temperatureCible = object.value.temperatureCible || 0\r\n    form.value.mode = object.value.mode || ''\r\n    form.value.statut = object.value.statut || 'Actif'\r\n\r\n  } catch (error) {\r\n    console.error('Erreur lors du chargement de l\\'objet:', error)\r\n  }\r\n})\r\n\r\nconst applyChanges = async () => {\r\n  try {\r\n    const id = route.params.id\r\n    await api.put(`/objets/${id}/control`, {\r\n      temperatureCible: form.value.temperatureCible,\r\n      mode: form.value.mode,\r\n      statut: form.value.statut\r\n    });\r\n    alert('✅ Modifications enregistrées avec succès !')\r\n  } catch (error) {\r\n    console.error('❌ Erreur API PUT:', error)\r\n    alert('Erreur lors de la mise à jour de l\\'objet.')\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <AppLayout>\r\n    <div class=\"control-object-page\">\r\n      <h1>Contrôler l'objet</h1>\r\n\r\n      <div v-if=\"object\" class=\"object-form\">\r\n        <h2>{{ object.nom }}</h2>\r\n\r\n        <!-- Température -->\r\n        <div v-if=\"showTemperature\" class=\"form-group\">\r\n          <label>Température cible (°C)</label>\r\n          <input v-model=\"form.temperatureCible\" type=\"number\" />\r\n        </div>\r\n\r\n        <!-- Mode -->\r\n        <div v-if=\"showMode\" class=\"form-group\">\r\n          <label>Mode</label>\r\n\r\n          <select v-if=\"object.modesDisponibles.length > 0\" v-model=\"form.mode\">\r\n            <option v-for=\"option in object.modesDisponibles\" :key=\"option\" :value=\"option\">\r\n              {{ option }}\r\n            </option>\r\n          </select>\r\n\r\n          <input\r\n              v-else\r\n              v-model=\"form.mode\"\r\n              type=\"text\"\r\n              placeholder=\"Entrer un mode manuellement\"\r\n          />\r\n        </div>\r\n\r\n        <!-- Statut -->\r\n        <div class=\"form-group\">\r\n          <label>Statut</label>\r\n          <select v-model=\"form.statut\">\r\n            <option value=\"Actif\">Actif</option>\r\n            <option value=\"Inactif\">Inactif</option>\r\n          </select>\r\n        </div>\r\n\r\n        <button @click=\"applyChanges\" class=\"btn-apply\">Appliquer les changements</button>\r\n      </div>\r\n\r\n      <div v-else>\r\n        <p>Chargement de l'objet...</p>\r\n      </div>\r\n    </div>\r\n  </AppLayout>\r\n</template>\r\n\r\n<style scoped>\r\n.object-form {\r\n  margin-top: 20px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\ninput, select {\r\n  width: 100%;\r\n  padding: 8px;\r\n  margin-top: 5px;\r\n}\r\n\r\n.btn-apply {\r\n  padding: 10px 20px;\r\n  background-color: #4caf50;\r\n  color: white;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n\r\n\r\n\r\n<style scoped>\r\n.object-form {\r\n  margin-top: 20px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\ninput, select {\r\n  width: 100%;\r\n  padding: 8px;\r\n  margin-top: 5px;\r\n}\r\n.btn-apply {\r\n  padding: 10px 20px;\r\n  background-color: #4caf50;\r\n  color: white;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\n\r\n</style>"],"mappings":"AACA,SAASA,SAAS,EAAEC,GAAG,EAAEC,QAAQ,QAAQ,KAAK;AAC9C,SAASC,QAAQ,QAAQ,YAAY;AACrC,OAAOC,GAAG,MAAM,gBAAgB;AAChC,OAAOC,SAAS,MAAM,8BAA8B;;;;;;;IAEpD,MAAMC,KAAK,GAAGH,QAAQ,CAAC,CAAC;IACxB,MAAMI,MAAM,GAAGN,GAAG,CAAC,IAAI,CAAC;IACxB,MAAMO,IAAI,GAAGP,GAAG,CAAC;MACfQ,gBAAgB,EAAE,CAAC;MACnBC,IAAI,EAAE,EAAE;MACRC,MAAM,EAAE;IACV,CAAC,CAAC;;IAEF;IACA,MAAMC,eAAe,GAAGV,QAAQ,CAAC,MAAMK,MAAM,CAACM,KAAK,EAAEC,mBAAmB,CAAC;IACzE,MAAMC,QAAQ,GAAGb,QAAQ,CAAC,MAAMK,MAAM,CAACM,KAAK,EAAEG,YAAY,CAAC;IAE3DhB,SAAS,CAAC,YAAY;MACpB,IAAI;QACF,MAAMiB,EAAE,GAAGX,KAAK,CAACY,MAAM,CAACD,EAAE;QAC1B,MAAME,GAAG,GAAG,MAAMf,GAAG,CAACgB,GAAG,CAAC,WAAWH,EAAE,EAAE,CAAC;QAC1C,MAAMI,IAAI,GAAGF,GAAG,CAACE,IAAI;QAErBd,MAAM,CAACM,KAAK,GAAG;UACbS,GAAG,EAAED,IAAI,CAACC,GAAG;UACbC,GAAG,EAAEF,IAAI,CAACE,GAAG;UACbd,gBAAgB,EAAEY,IAAI,CAACZ,gBAAgB;UACvCC,IAAI,EAAEW,IAAI,CAACX,IAAI;UACfC,MAAM,EAAEU,IAAI,CAACV,MAAM;UACnBG,mBAAmB,EAAEO,IAAI,CAACP,mBAAmB;UAC7CE,YAAY,EAAEK,IAAI,CAACL,YAAY;UAC/BQ,gBAAgB,EAAEH,IAAI,CAACG,gBAAgB,IAAI;QAC7C,CAAC;QAEDhB,IAAI,CAACK,KAAK,CAACJ,gBAAgB,GAAGF,MAAM,CAACM,KAAK,CAACJ,gBAAgB,IAAI,CAAC;QAChED,IAAI,CAACK,KAAK,CAACH,IAAI,GAAGH,MAAM,CAACM,KAAK,CAACH,IAAI,IAAI,EAAE;QACzCF,IAAI,CAACK,KAAK,CAACF,MAAM,GAAGJ,MAAM,CAACM,KAAK,CAACF,MAAM,IAAI,OAAO;MAEpD,CAAC,CAAC,OAAOc,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;MAChE;IACF,CAAC,CAAC;IAEF,MAAME,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAI;QACF,MAAMV,EAAE,GAAGX,KAAK,CAACY,MAAM,CAACD,EAAE;QAC1B,MAAMb,GAAG,CAACwB,GAAG,CAAC,WAAWX,EAAE,UAAU,EAAE;UACrCR,gBAAgB,EAAED,IAAI,CAACK,KAAK,CAACJ,gBAAgB;UAC7CC,IAAI,EAAEF,IAAI,CAACK,KAAK,CAACH,IAAI;UACrBC,MAAM,EAAEH,IAAI,CAACK,KAAK,CAACF;QACrB,CAAC,CAAC;QACFkB,KAAK,CAAC,4CAA4C,CAAC;MACrD,CAAC,CAAC,OAAOJ,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEA,KAAK,CAAC;QACzCI,KAAK,CAAC,4CAA4C,CAAC;MACrD;IACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}