{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, vModelSelect as _vModelSelect, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"history-container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_3 = {\n  class: \"filters-container\"\n};\nconst _hoisted_4 = {\n  class: \"search-box\"\n};\nconst _hoisted_5 = {\n  class: \"family-filter\"\n};\nconst _hoisted_6 = [\"value\"];\nconst _hoisted_7 = {\n  class: \"category-filter\"\n};\nconst _hoisted_8 = [\"value\"];\nconst _hoisted_9 = {\n  key: 1,\n  class: \"no-results\"\n};\nconst _hoisted_10 = {\n  class: \"users-container\"\n};\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = {\n  class: \"user-info\"\n};\nconst _hoisted_13 = [\"src\"];\nconst _hoisted_14 = {\n  class: \"user-details\"\n};\nconst _hoisted_15 = {\n  class: \"action-count\"\n};\nconst _hoisted_16 = {\n  key: 0,\n  class: \"categories-container\"\n};\nconst _hoisted_17 = [\"onClick\"];\nconst _hoisted_18 = {\n  class: \"category-info\"\n};\nconst _hoisted_19 = {\n  class: \"category-details\"\n};\nconst _hoisted_20 = {\n  class: \"category-count\"\n};\nconst _hoisted_21 = {\n  class: \"category-meta\"\n};\nconst _hoisted_22 = {\n  class: \"last-update-date\"\n};\nconst _hoisted_23 = {\n  key: 0,\n  class: \"timeline-container\"\n};\nconst _hoisted_24 = {\n  class: \"timeline\"\n};\nconst _hoisted_25 = {\n  class: \"timeline-content\"\n};\nconst _hoisted_26 = {\n  class: \"action-header\"\n};\nconst _hoisted_27 = {\n  class: \"action-date\"\n};\nconst _hoisted_28 = {\n  key: 0,\n  class: \"action-details\"\n};\nconst _hoisted_29 = {\n  class: \"detail-label\"\n};\nconst _hoisted_30 = {\n  class: \"detail-value\"\n};\nconst _hoisted_31 = {\n  class: \"action-meta\"\n};\nconst _hoisted_32 = {\n  key: 0,\n  class: \"meta-item\"\n};\nconst _hoisted_33 = {\n  key: 1,\n  class: \"meta-item\"\n};\nconst _hoisted_34 = {\n  key: 2,\n  class: \"pagination\"\n};\nconst _hoisted_35 = [\"disabled\"];\nconst _hoisted_36 = {\n  class: \"page-info\"\n};\nconst _hoisted_37 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_AppLayout = _resolveComponent(\"AppLayout\");\n  return _openBlock(), _createBlock(_component_AppLayout, null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_cache[19] || (_cache[19] = _createElementVNode(\"h1\", {\n      class: \"page-title\"\n    }, \"Historique des actions\", -1 /* HOISTED */)), _createCommentVNode(\" Message d'erreur \"), $setup.errorMessage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_cache[8] || (_cache[8] = _createElementVNode(\"i\", {\n      class: \"fas fa-exclamation-triangle\"\n    }, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.errorMessage), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Filtres et recherche \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"input\", {\n      type: \"text\",\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchTerm = $event),\n      placeholder: \"Rechercher...\",\n      onInput: _cache[1] || (_cache[1] = (...args) => $setup.debounceSearch && $setup.debounceSearch(...args))\n    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $setup.searchTerm]]), _cache[9] || (_cache[9] = _createElementVNode(\"i\", {\n      class: \"fas fa-search search-icon\"\n    }, null, -1 /* HOISTED */))]), _createElementVNode(\"div\", _hoisted_5, [_withDirectives(_createElementVNode(\"select\", {\n      id: \"family-select\",\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.selectedFamilleId = $event),\n      onChange: _cache[3] || (_cache[3] = $event => $setup.debounceSearch())\n    }, [_cache[10] || (_cache[10] = _createElementVNode(\"option\", {\n      value: \"\"\n    }, \"Toutes les familles\", -1 /* HOISTED */)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.familles, famille => {\n      return _openBlock(), _createElementBlock(\"option\", {\n        key: famille._id,\n        value: famille._id\n      }, _toDisplayString(famille.codeFamille || famille._id), 9 /* TEXT, PROPS */, _hoisted_6);\n    }), 128 /* KEYED_FRAGMENT */))], 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelSelect, $setup.selectedFamilleId]])]), _createElementVNode(\"div\", _hoisted_7, [_withDirectives(_createElementVNode(\"select\", {\n      \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.selectedCategory = $event),\n      onChange: _cache[5] || (_cache[5] = $event => $setup.debounceSearch())\n    }, [_cache[11] || (_cache[11] = _createElementVNode(\"option\", {\n      value: \"\"\n    }, \"Toutes les catégories\", -1 /* HOISTED */)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.actionCategories, cat => {\n      return _openBlock(), _createElementBlock(\"option\", {\n        key: cat,\n        value: cat\n      }, _toDisplayString($setup.formatAction(cat)), 9 /* TEXT, PROPS */, _hoisted_8);\n    }), 128 /* KEYED_FRAGMENT */))], 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelSelect, $setup.selectedCategory]])])]), _createCommentVNode(\" Affichage du message si aucun résultat \"), $setup.logs.length === 0 && !$setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, _cache[12] || (_cache[12] = [_createElementVNode(\"p\", null, \"Aucun résultat ne correspond à votre recherche\", -1 /* HOISTED */)]))) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Liste des utilisateurs \"), _createElementVNode(\"div\", _hoisted_10, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.displayedUsers, (userHistory, index) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: index,\n        class: \"user-card\"\n      }, [_createElementVNode(\"div\", {\n        class: \"user-header\",\n        onClick: $event => $setup.toggleUser(userHistory.user.email)\n      }, [_createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"img\", {\n        src: $setup.getPhotoUrl(userHistory.user.photo, userHistory.user._id),\n        class: \"user-avatar\",\n        alt: \"Avatar\"\n      }, null, 8 /* PROPS */, _hoisted_13), _createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"h3\", null, _toDisplayString(userHistory.user.email), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_15, _toDisplayString($setup.getActionsToday(userHistory.user.email)) + \" action(s) aujourd'hui \", 1 /* TEXT */)])]), _createElementVNode(\"div\", {\n        class: _normalizeClass([\"expand-button\", {\n          'expanded': $setup.expandedUsers.includes(userHistory.user.email)\n        }])\n      }, [...(_cache[13] || (_cache[13] = [_createElementVNode(\"i\", {\n        class: \"fas fa-chevron-down\"\n      }, null, -1 /* HOISTED */)]))], 2 /* CLASS */)], 8 /* PROPS */, _hoisted_11), _createCommentVNode(\" Catégories d'actions de l'utilisateur \"), $setup.expandedUsers.includes(userHistory.user.email) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(userHistory.categories, (actions, category) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: category,\n          class: \"category-section\"\n        }, [_createElementVNode(\"div\", {\n          class: \"category-header\",\n          onClick: $event => $setup.toggleCategory(userHistory.user.email, category)\n        }, [_createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"span\", {\n          class: _normalizeClass(['category-icon', $setup.getActionClass(category)])\n        }, [_createElementVNode(\"i\", {\n          class: _normalizeClass($setup.getCategoryIcon(category))\n        }, null, 2 /* CLASS */)], 2 /* CLASS */), _createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"h4\", null, _toDisplayString($setup.formatAction(category)), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_20, _toDisplayString(actions.length) + \" action(s)\", 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"span\", _hoisted_22, \"Dernière action: \" + _toDisplayString($setup.formatDate(actions[0].date)), 1 /* TEXT */), _createElementVNode(\"div\", {\n          class: _normalizeClass([\"expand-button\", {\n            'expanded': $setup.isExpandedCategory(userHistory.user.email, category)\n          }])\n        }, [...(_cache[14] || (_cache[14] = [_createElementVNode(\"i\", {\n          class: \"fas fa-chevron-down\"\n        }, null, -1 /* HOISTED */)]))], 2 /* CLASS */)])], 8 /* PROPS */, _hoisted_17), _createCommentVNode(\" Timeline des actions de la catégorie \"), $setup.isExpandedCategory(userHistory.user.email, category) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [_createElementVNode(\"div\", _hoisted_24, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(actions, action => {\n          return _openBlock(), _createElementBlock(\"div\", {\n            key: action._id,\n            class: \"timeline-item\"\n          }, [_createElementVNode(\"div\", {\n            class: _normalizeClass([\"timeline-point\", $setup.getActionClass(category)])\n          }, null, 2 /* CLASS */), _createElementVNode(\"div\", _hoisted_25, [_createElementVNode(\"div\", _hoisted_26, [_createElementVNode(\"span\", _hoisted_27, _toDisplayString($setup.formatDate(action.date)), 1 /* TEXT */)]), action.details ? (_openBlock(), _createElementBlock(\"div\", _hoisted_28, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(action.details, (value, key) => {\n            return _openBlock(), _createElementBlock(\"div\", {\n              key: key,\n              class: \"detail-item\"\n            }, [_createElementVNode(\"span\", _hoisted_29, _toDisplayString($setup.formatDetailKey(key)) + \":\", 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_30, _toDisplayString(value), 1 /* TEXT */)]);\n          }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_31, [action.ip ? (_openBlock(), _createElementBlock(\"span\", _hoisted_32, [_cache[15] || (_cache[15] = _createElementVNode(\"i\", {\n            class: \"fas fa-network-wired\"\n          }, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(action.ip), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), action.userAgent ? (_openBlock(), _createElementBlock(\"span\", _hoisted_33, [_cache[16] || (_cache[16] = _createElementVNode(\"i\", {\n            class: \"fas fa-laptop\"\n          }, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.formatUserAgent(action.userAgent)), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)])])]);\n        }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)]);\n      }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true)]);\n    }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" Pagination \"), $setup.totalUserPages > 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_34, [_createElementVNode(\"button\", {\n      disabled: $setup.currentPage === 1,\n      onClick: _cache[6] || (_cache[6] = $event => $setup.changePage($setup.currentPage - 1)),\n      class: \"page-btn\"\n    }, _cache[17] || (_cache[17] = [_createElementVNode(\"i\", {\n      class: \"fas fa-chevron-left\"\n    }, null, -1 /* HOISTED */), _createTextVNode(\" Précédent \")]), 8 /* PROPS */, _hoisted_35), _createElementVNode(\"span\", _hoisted_36, \"Page \" + _toDisplayString($setup.currentPage) + \" sur \" + _toDisplayString($setup.totalUserPages), 1 /* TEXT */), _createElementVNode(\"button\", {\n      disabled: $setup.currentPage === $setup.totalUserPages,\n      onClick: _cache[7] || (_cache[7] = $event => $setup.changePage($setup.currentPage + 1)),\n      class: \"page-btn\"\n    }, _cache[18] || (_cache[18] = [_createTextVNode(\" Suivant \"), _createElementVNode(\"i\", {\n      class: \"fas fa-chevron-right\"\n    }, null, -1 /* HOISTED */)]), 8 /* PROPS */, _hoisted_37)])) : _createCommentVNode(\"v-if\", true)])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","key","_createBlock","_component_AppLayout","default","_withCtx","_createElementVNode","_hoisted_1","_createCommentVNode","$setup","errorMessage","_createElementBlock","_hoisted_2","_createTextVNode","_toDisplayString","_hoisted_3","_hoisted_4","type","_cache","$event","searchTerm","placeholder","onInput","args","debounceSearch","_hoisted_5","id","selectedFamilleId","onChange","value","_Fragment","_renderList","familles","famille","_id","codeFamille","_hoisted_6","_hoisted_7","selectedCategory","actionCategories","cat","formatAction","_hoisted_8","logs","length","loading","_hoisted_9","_hoisted_10","displayedUsers","userHistory","index","onClick","toggleUser","user","email","_hoisted_12","src","getPhotoUrl","photo","alt","_hoisted_13","_hoisted_14","_hoisted_15","getActionsToday","_normalizeClass","expandedUsers","includes","_hoisted_11","_hoisted_16","categories","actions","category","toggleCategory","_hoisted_18","getActionClass","getCategoryIcon","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","formatDate","date","isExpandedCategory","_hoisted_17","_hoisted_23","_hoisted_24","action","_hoisted_25","_hoisted_26","_hoisted_27","details","_hoisted_28","_hoisted_29","formatDetailKey","_hoisted_30","_hoisted_31","ip","_hoisted_32","userAgent","_hoisted_33","formatUserAgent","totalUserPages","_hoisted_34","disabled","currentPage","changePage","_hoisted_35","_hoisted_36","_hoisted_37","_"],"sources":["C:\\Users\\benab\\Desktop\\COURS 24_25\\S2\\WEB\\V4\\Projet_WEB_ING1\\frontend\\src\\views\\AdminHistory.vue"],"sourcesContent":["<template>\r\n  <AppLayout>\r\n    <div class=\"history-container\">\r\n      <h1 class=\"page-title\">Historique des actions</h1>\r\n\r\n      <!-- Message d'erreur -->\r\n      <div v-if=\"errorMessage\" class=\"error-message\">\r\n        <i class=\"fas fa-exclamation-triangle\"></i> {{ errorMessage }}\r\n      </div>\r\n\r\n      <!-- Filtres et recherche -->\r\n      <div class=\"filters-container\">\r\n        <div class=\"search-box\">\r\n          <input\r\n              type=\"text\"\r\n              v-model=\"searchTerm\"\r\n              placeholder=\"Rechercher...\"\r\n              @input=\"debounceSearch\"\r\n          />\r\n          <i class=\"fas fa-search search-icon\"></i>\r\n        </div>\r\n\r\n        <div class=\"family-filter\">\r\n          <select id=\"family-select\" v-model=\"selectedFamilleId\" @change=\"debounceSearch()\">\r\n            <option value=\"\">Toutes les familles</option>\r\n            <option v-for=\"famille in familles\" :key=\"famille._id\" :value=\"famille._id\">\r\n              {{ famille.codeFamille || famille._id }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n\r\n        <div class=\"category-filter\">\r\n          <select v-model=\"selectedCategory\" @change=\"debounceSearch()\">\r\n            <option value=\"\">Toutes les catégories</option>\r\n            <option v-for=\"cat in actionCategories\" :key=\"cat\" :value=\"cat\">\r\n              {{ formatAction(cat) }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Affichage du message si aucun résultat -->\r\n      <div v-if=\"logs.length === 0 && !loading\" class=\"no-results\">\r\n        <p>Aucun résultat ne correspond à votre recherche</p>\r\n      </div>\r\n\r\n      <!-- Liste des utilisateurs -->\r\n      <div class=\"users-container\">\r\n        <div v-for=\"(userHistory, index) in displayedUsers\" :key=\"index\" class=\"user-card\">\r\n          <div class=\"user-header\" @click=\"toggleUser(userHistory.user.email)\">\r\n            <div class=\"user-info\">\r\n              <img :src=\"getPhotoUrl(userHistory.user.photo, userHistory.user._id)\" class=\"user-avatar\" alt=\"Avatar\">\r\n              <div class=\"user-details\">\r\n                <h3>{{ userHistory.user.email }}</h3>\r\n                <span class=\"action-count\">\r\n                  {{ getActionsToday(userHistory.user.email) }} action(s) aujourd'hui\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div class=\"expand-button\" :class=\"{ 'expanded': expandedUsers.includes(userHistory.user.email) }\">\r\n              <i class=\"fas fa-chevron-down\"></i>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Catégories d'actions de l'utilisateur -->\r\n          <div v-if=\"expandedUsers.includes(userHistory.user.email)\" class=\"categories-container\">\r\n            <div v-for=\"(actions, category) in userHistory.categories\" :key=\"category\" class=\"category-section\">\r\n              <div class=\"category-header\" @click=\"toggleCategory(userHistory.user.email, category)\">\r\n                <div class=\"category-info\">\r\n                  <span :class=\"['category-icon', getActionClass(category)]\">\r\n                    <i :class=\"getCategoryIcon(category)\"></i>\r\n                  </span>\r\n                  <div class=\"category-details\">\r\n                    <h4>{{ formatAction(category) }}</h4>\r\n                    <span class=\"category-count\">{{ actions.length }} action(s)</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"category-meta\">\r\n                  <span class=\"last-update-date\">Dernière action: {{ formatDate(actions[0].date) }}</span>\r\n                  <div class=\"expand-button\" :class=\"{ 'expanded': isExpandedCategory(userHistory.user.email, category) }\">\r\n                    <i class=\"fas fa-chevron-down\"></i>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Timeline des actions de la catégorie -->\r\n              <div v-if=\"isExpandedCategory(userHistory.user.email, category)\" class=\"timeline-container\">\r\n                <div class=\"timeline\">\r\n                  <div v-for=\"action in actions\" :key=\"action._id\" class=\"timeline-item\">\r\n                    <div class=\"timeline-point\" :class=\"getActionClass(category)\"></div>\r\n                    <div class=\"timeline-content\">\r\n                      <div class=\"action-header\">\r\n                        <span class=\"action-date\">{{ formatDate(action.date) }}</span>\r\n                      </div>\r\n                      <div class=\"action-details\" v-if=\"action.details\">\r\n                        <div v-for=\"(value, key) in action.details\" :key=\"key\" class=\"detail-item\">\r\n                          <span class=\"detail-label\">{{ formatDetailKey(key) }}:</span>\r\n                          <span class=\"detail-value\">{{ value }}</span>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"action-meta\">\r\n                        <span class=\"meta-item\" v-if=\"action.ip\">\r\n                          <i class=\"fas fa-network-wired\"></i> {{ action.ip }}\r\n                        </span>\r\n                        <span class=\"meta-item\" v-if=\"action.userAgent\">\r\n                          <i class=\"fas fa-laptop\"></i> {{ formatUserAgent(action.userAgent) }}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Pagination -->\r\n      <div class=\"pagination\" v-if=\"totalUserPages > 1\">\r\n        <button\r\n            :disabled=\"currentPage === 1\"\r\n            @click=\"changePage(currentPage - 1)\"\r\n            class=\"page-btn\"\r\n        >\r\n          <i class=\"fas fa-chevron-left\"></i> Précédent\r\n        </button>\r\n        <span class=\"page-info\">Page {{ currentPage }} sur {{ totalUserPages }}</span>\r\n        <button\r\n            :disabled=\"currentPage === totalUserPages\"\r\n            @click=\"changePage(currentPage + 1)\"\r\n            class=\"page-btn\"\r\n        >\r\n          Suivant <i class=\"fas fa-chevron-right\"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </AppLayout>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed, watch } from 'vue';\r\nimport AppLayout from '@/layout/AppLayoutGlobal.vue';\r\nimport api from '@/services/api';\r\nimport defaultAvatar from '@/assets/default-avatar.png';\r\nimport { getPhotoUrl } from '@/utils/photo';\r\n\r\nexport default {\r\n  name: 'AdminHistory',\r\n  components: {\r\n    AppLayout\r\n  },\r\n  setup() {\r\n    const logs = ref([]);\r\n    const allUserActions = ref({}); // Stockage des actions d'aujourd'hui pour tous les utilisateurs\r\n    const currentPage = ref(1);\r\n    const totalPages = ref(1);\r\n    const loading = ref(false);\r\n    const expandedUsers = ref([]);\r\n    const expandedCategories = ref(new Map());\r\n    const searchTerm = ref('');\r\n    const selectedFamilleId = ref('');\r\n    const familles = ref([]);\r\n    const searchTimeout = ref(null);\r\n    const usersPerPage = 7; // Nombre d'utilisateurs par page\r\n    const errorMessage = ref('');\r\n    const selectedCategory = ref('');\r\n\r\n    // Extraire toutes les catégories d'action possibles à partir des logs ou d'une liste statique\r\n    const actionCategories = [\r\n      'connexion', 'deconnexion', 'creation_utilisateur', 'modification_utilisateur', 'suppression_utilisateur', 'validation_compte', 'ajout_points',\r\n      'creation_famille', 'modification_famille', 'suppression_famille', 'ajout_membre_famille', 'retrait_membre_famille',\r\n      'creation_recette', 'modification_recette', 'suppression_recette', 'notation_recette', 'commentaire_recette',\r\n      'creation_objet', 'modification_objet', 'suppression_objet', 'utilisation_objet'\r\n    ];\r\n\r\n    // Chargement de toutes les actions d'aujourd'hui pour référence\r\n    const loadAllTodayActions = async () => {\r\n      try {\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n\r\n        const response = await api.get('/history?limit=1000'); // Demander un grand nombre pour avoir toutes les actions\r\n        const allLogs = response.data.histories || [];\r\n\r\n        // Compter les actions d'aujourd'hui par utilisateur\r\n        const actionsByUser = {};\r\n\r\n        allLogs.forEach(log => {\r\n          if (!log.user) return;\r\n\r\n          const actionDate = new Date(log.date);\r\n          const userEmail = log.user.email;\r\n\r\n          if (actionDate >= today) {\r\n            if (!actionsByUser[userEmail]) {\r\n              actionsByUser[userEmail] = {\r\n                count: 0,\r\n                user: log.user\r\n              };\r\n            }\r\n            actionsByUser[userEmail].count++;\r\n          }\r\n        });\r\n\r\n        allUserActions.value = actionsByUser;\r\n      } catch (error) {\r\n        console.error('Erreur lors du chargement des actions totales:', error);\r\n      }\r\n    };\r\n\r\n    const loadFamilles = async () => {\r\n      try {\r\n        const response = await api.get('/history/familles');\r\n        familles.value = response.data.familles || [];\r\n      } catch (error) {\r\n        console.error('Erreur lors du chargement des familles:', error);\r\n      }\r\n    };\r\n\r\n    const loadHistory = async (page = 1) => {\r\n      try {\r\n        loading.value = true;\r\n        errorMessage.value = '';\r\n        currentPage.value = page;\r\n\r\n        const params = new URLSearchParams();\r\n        params.append('page', page);\r\n        params.append('limit', 100); // Demander plus d'actions pour avoir assez d'utilisateurs distincts\r\n\r\n        if (searchTerm.value) {\r\n          params.append('search', searchTerm.value);\r\n        }\r\n\r\n        if (selectedFamilleId.value) {\r\n          params.append('familleId', selectedFamilleId.value);\r\n        }\r\n\r\n        const response = await api.get(`/history?${params.toString()}`);\r\n        logs.value = response.data.histories || [];\r\n        totalPages.value = response.data.pagination.pages;\r\n      } catch (error) {\r\n        console.error('Erreur lors du chargement de l\\'historique:', error);\r\n        logs.value = [];\r\n        errorMessage.value = \"Erreur lors du chargement de l'historique. Veuillez réessayer.\";\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const debounceSearch = () => {\r\n      if (searchTimeout.value) {\r\n        clearTimeout(searchTimeout.value);\r\n      }\r\n\r\n      searchTimeout.value = setTimeout(() => {\r\n        loadHistory(1); // Retour à la première page lors d'une recherche\r\n      }, 300); // Délai de 300ms pour éviter trop de requêtes\r\n    };\r\n\r\n    // Grouper les logs par utilisateur\r\n    const groupedByUser = computed(() => {\r\n      // Grouper les logs par utilisateur\r\n      const users = {};\r\n      logs.value.forEach(log => {\r\n        if (!log.user) return;\r\n        // Si filtre famille actif, ne garder que les utilisateurs de cette famille\r\n        if (selectedFamilleId.value && log.user.famille !== selectedFamilleId.value) return;\r\n        const email = log.user.email;\r\n        if (!users[email]) {\r\n          users[email] = { user: log.user, categories: {} };\r\n        }\r\n        // Si filtre catégorie actif, ne garder que les actions de cette catégorie\r\n        if (selectedCategory.value && log.action !== selectedCategory.value) return;\r\n        if (!users[email].categories[log.action]) {\r\n          users[email].categories[log.action] = [];\r\n        }\r\n        users[email].categories[log.action].push(log);\r\n      });\r\n      // Ne garder que les utilisateurs qui ont au moins une action (après filtrage)\r\n      return Object.values(users).filter(u => Object.values(u.categories).some(actions => actions.length > 0));\r\n    });\r\n\r\n    // Nombre total de pages d'utilisateurs (7 utilisateurs par page)\r\n    const totalUserPages = computed(() => {\r\n      return Math.ceil(groupedByUser.value.length / usersPerPage);\r\n    });\r\n\r\n    // Utilisateurs à afficher pour la page courante (pagination côté client)\r\n    const displayedUsers = computed(() => {\r\n      const start = (currentPage.value - 1) * usersPerPage;\r\n      const end = start + usersPerPage;\r\n\r\n      // S'assurer que nous avons des utilisateurs avec des actions correspondant au filtre\r\n      const filteredUsers = groupedByUser.value.filter(userHistory => {\r\n        // Si aucun filtre famille n'est appliqué, afficher cet utilisateur\r\n        if (!selectedFamilleId.value) {\r\n          return true;\r\n        }\r\n\r\n        // Vérifier si l'utilisateur a des actions liées à la famille sélectionnée\r\n        // (les logs ont déjà été filtrés par le backend, donc si l'utilisateur apparaît,\r\n        // c'est qu'il a au moins une action liée à cette famille)\r\n        return Object.values(userHistory.categories).some(actions => actions.length > 0);\r\n      });\r\n\r\n      return filteredUsers.slice(start, end);\r\n    });\r\n\r\n    const getTotalActions = (categories) => {\r\n      return Object.values(categories).reduce((total, actions) => total + actions.length, 0);\r\n    };\r\n\r\n    const getActionsToday = (userEmail) => {\r\n      return allUserActions.value[userEmail]?.count || 0;\r\n    };\r\n\r\n    const toggleUser = (userEmail) => {\r\n      const index = expandedUsers.value.indexOf(userEmail);\r\n      if (index === -1) {\r\n        expandedUsers.value.push(userEmail);\r\n      } else {\r\n        expandedUsers.value.splice(index, 1);\r\n        // Fermer toutes les catégories de cet utilisateur\r\n        expandedCategories.value.delete(userEmail);\r\n      }\r\n    };\r\n\r\n    const toggleCategory = (userEmail, category) => {\r\n      if (!expandedCategories.value.has(userEmail)) {\r\n        expandedCategories.value.set(userEmail, new Set());\r\n      }\r\n\r\n      const userCategories = expandedCategories.value.get(userEmail);\r\n      if (userCategories.has(category)) {\r\n        userCategories.delete(category);\r\n      } else {\r\n        userCategories.add(category);\r\n      }\r\n    };\r\n\r\n    const isExpandedCategory = (userEmail, category) => {\r\n      return expandedCategories.value.has(userEmail) &&\r\n          expandedCategories.value.get(userEmail).has(category);\r\n    };\r\n\r\n    const getCategoryIcon = (action) => {\r\n      const icons = {\r\n        // Utilisateurs\r\n        'connexion': 'fas fa-sign-in-alt',\r\n        'deconnexion': 'fas fa-sign-out-alt',\r\n        'creation_utilisateur': 'fas fa-user-plus',\r\n        'modification_utilisateur': 'fas fa-user-edit',\r\n        'suppression_utilisateur': 'fas fa-user-minus',\r\n        'validation_compte': 'fas fa-user-check',\r\n        'ajout_points': 'fas fa-star',\r\n\r\n        // Familles\r\n        'creation_famille': 'fas fa-users-cog',\r\n        'modification_famille': 'fas fa-users-cog',\r\n        'suppression_famille': 'fas fa-users-slash',\r\n        'ajout_membre_famille': 'fas fa-user-plus',\r\n        'retrait_membre_famille': 'fas fa-user-minus',\r\n\r\n        // Recettes\r\n        'creation_recette': 'fas fa-utensils',\r\n        'modification_recette': 'fas fa-edit',\r\n        'suppression_recette': 'fas fa-trash-alt',\r\n        'notation_recette': 'fas fa-star',\r\n        'commentaire_recette': 'fas fa-comment',\r\n\r\n        // Objets/Ingrédients\r\n        'creation_objet': 'fas fa-plus-circle',\r\n        'modification_objet': 'fas fa-edit',\r\n        'suppression_objet': 'fas fa-trash-alt',\r\n        'utilisation_objet': 'fas fa-hand-pointer'\r\n      };\r\n      return icons[action] || 'fas fa-history';\r\n    };\r\n\r\n    const formatDate = (date) => {\r\n      return new Date(date).toLocaleString('fr-FR', {\r\n        day: '2-digit',\r\n        month: '2-digit',\r\n        year: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit'\r\n      });\r\n    };\r\n\r\n    const formatAction = (action) => {\r\n      const actions = {\r\n        // Utilisateurs\r\n        'connexion': 'Connexions',\r\n        'deconnexion': 'Déconnexions',\r\n        'creation_utilisateur': 'Créations d\\'utilisateurs',\r\n        'modification_utilisateur': 'Modifications d\\'utilisateurs',\r\n        'suppression_utilisateur': 'Suppressions d\\'utilisateurs',\r\n        'validation_compte': 'Validations de compte',\r\n        'ajout_points': 'Ajouts de points',\r\n\r\n        // Familles\r\n        'creation_famille': 'Créations de familles',\r\n        'modification_famille': 'Modifications de familles',\r\n        'suppression_famille': 'Suppressions de familles',\r\n        'ajout_membre_famille': 'Ajouts de membres',\r\n        'retrait_membre_famille': 'Retraits de membres',\r\n\r\n        // Recettes\r\n        'creation_recette': 'Créations de recettes',\r\n        'modification_recette': 'Modifications de recettes',\r\n        'suppression_recette': 'Suppressions de recettes',\r\n        'notation_recette': 'Notations de recettes',\r\n        'commentaire_recette': 'Commentaires de recettes',\r\n\r\n        // Objets/Ingrédients\r\n        'creation_objet': 'Créations d\\'objets',\r\n        'modification_objet': 'Modifications d\\'objets',\r\n        'suppression_objet': 'Suppressions d\\'objets',\r\n        'utilisation_objet': 'Utilisations d\\'objets'\r\n      };\r\n      return actions[action] || action;\r\n    };\r\n\r\n    const getActionClass = (action) => {\r\n      const actionType = action.split('_')[0];\r\n      const classes = {\r\n        'connexion': 'action-connexion',\r\n        'deconnexion': 'action-deconnexion',\r\n        'creation': 'action-creation',\r\n        'modification': 'action-modification',\r\n        'suppression': 'action-suppression',\r\n        'ajout': 'action-ajout',\r\n        'retrait': 'action-retrait',\r\n        'validation': 'action-validation',\r\n        'notation': 'action-notation',\r\n        'commentaire': 'action-commentaire',\r\n        'utilisation': 'action-utilisation'\r\n      };\r\n      return classes[actionType] || '';\r\n    };\r\n\r\n    const formatDetailKey = (key) => {\r\n      return key.charAt(0).toUpperCase() + key.slice(1).replace(/_/g, ' ');\r\n    };\r\n\r\n    const formatUserAgent = (userAgent) => {\r\n      if (!userAgent) return '';\r\n      return userAgent.split(' ')[0];\r\n    };\r\n\r\n    const changePage = (page) => {\r\n      if (page >= 1 && page <= totalUserPages.value) {\r\n        currentPage.value = page;\r\n\r\n        // Si on change de page, on ferme tous les utilisateurs développés\r\n        expandedUsers.value = [];\r\n        expandedCategories.value = new Map();\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      loadAllTodayActions(); // Charger d'abord toutes les actions d'aujourd'hui\r\n      loadHistory();\r\n      loadFamilles();\r\n    });\r\n\r\n    // Réinitialiser la page quand les filtres changent\r\n    watch([selectedFamilleId, searchTerm], () => {\r\n      if (currentPage.value !== 1) {\r\n        currentPage.value = 1;\r\n      }\r\n      // Recharger l'historique quand les filtres changent\r\n      loadHistory(1);\r\n    });\r\n\r\n    return {\r\n      logs,\r\n      allUserActions,\r\n      currentPage,\r\n      totalPages,\r\n      totalUserPages,\r\n      groupedByUser,\r\n      displayedUsers,\r\n      expandedUsers,\r\n      defaultAvatar,\r\n      formatDate,\r\n      formatAction,\r\n      getActionClass,\r\n      getCategoryIcon,\r\n      formatDetailKey,\r\n      formatUserAgent,\r\n      toggleUser,\r\n      toggleCategory,\r\n      isExpandedCategory,\r\n      getTotalActions,\r\n      getActionsToday,\r\n      changePage,\r\n      searchTerm,\r\n      selectedFamilleId,\r\n      familles,\r\n      debounceSearch,\r\n      loading,\r\n      getPhotoUrl,\r\n      errorMessage,\r\n      selectedCategory,\r\n      actionCategories\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.history-container {\r\n  padding: 20px;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.page-title {\r\n  color: #2c5038;\r\n  margin-bottom: 30px;\r\n  font-size: 2rem;\r\n}\r\n\r\n/* Styles pour les filtres */\r\n.filters-container {\r\n  display: flex;\r\n  gap: 15px;\r\n  margin-bottom: 20px;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  flex-direction: row;\r\n}\r\n\r\n.search-box {\r\n  position: relative;\r\n  flex: 1;\r\n  min-width: 200px;\r\n}\r\n\r\n.search-box input {\r\n  width: 30%;\r\n  padding: 10px 15px 10px 40px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 30px;\r\n  font-size: 1rem;\r\n  outline: none;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.search-box input:focus {\r\n  border-color: #2c5038;\r\n}\r\n\r\n.search-icon {\r\n  position: absolute;\r\n  left: 15px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  color: #666;\r\n}\r\n\r\n.family-filter, .category-filter {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.family-filter label {\r\n  font-weight: bold;\r\n  color: #2c5038;\r\n}\r\n\r\n.family-filter select {\r\n  padding: 8px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 5px;\r\n  outline: none;\r\n  background-color: white;\r\n  font-size: 1rem;\r\n  min-width: 150px;\r\n}\r\n\r\n.category-filter select {\r\n  padding: 8px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 5px;\r\n  outline: none;\r\n  background-color: white;\r\n  font-size: 1rem;\r\n  min-width: 170px;\r\n}\r\n\r\n.users-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n}\r\n\r\n.user-card {\r\n  background: white;\r\n  border-radius: 12px;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n  overflow: hidden;\r\n}\r\n\r\n.user-header {\r\n  padding: 15px 20px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n  background-color: #f8f9fa;\r\n}\r\n\r\n.user-header:hover {\r\n  background-color: #e9ecef;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 15px;\r\n}\r\n\r\n.user-avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n}\r\n\r\n.user-details h3 {\r\n  margin: 0;\r\n  font-size: 1.1rem;\r\n  color: #2c5038;\r\n}\r\n\r\n.action-count {\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n}\r\n\r\n.categories-container {\r\n  padding: 15px;\r\n  background-color: white;\r\n}\r\n\r\n.category-section {\r\n  margin-bottom: 15px;\r\n  border: 1px solid #eee;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n}\r\n\r\n.category-header {\r\n  padding: 12px 15px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n  background-color: #fff;\r\n}\r\n\r\n.category-header:hover {\r\n  background-color: #f8f9fa;\r\n}\r\n\r\n.category-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.category-icon {\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: white;\r\n  font-size: 1rem;\r\n}\r\n\r\n.category-details h4 {\r\n  margin: 0;\r\n  font-size: 1rem;\r\n  color: #2c5038;\r\n}\r\n\r\n.category-count {\r\n  font-size: 0.8rem;\r\n  color: #666;\r\n}\r\n\r\n.category-meta {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.last-update-date {\r\n  font-size: 0.8rem;\r\n  color: #888;\r\n  font-style: italic;\r\n}\r\n\r\n.expand-button {\r\n  transition: transform 0.3s;\r\n}\r\n\r\n.expand-button.expanded {\r\n  transform: rotate(180deg);\r\n}\r\n\r\n.timeline-container {\r\n  padding: 15px;\r\n  background-color: #f8f9fa;\r\n}\r\n\r\n.timeline {\r\n  position: relative;\r\n  padding-left: 30px;\r\n}\r\n\r\n.timeline::before {\r\n  content: '';\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  width: 2px;\r\n  background-color: #ddd;\r\n}\r\n\r\n.timeline-item {\r\n  position: relative;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.timeline-point {\r\n  position: absolute;\r\n  left: -34px;\r\n  width: 12px;\r\n  height: 12px;\r\n  border-radius: 50%;\r\n  border: 2px solid white;\r\n}\r\n\r\n.timeline-content {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 15px;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n}\r\n\r\n.action-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.action-date {\r\n  font-size: 0.9em;\r\n  color: #666;\r\n}\r\n\r\n.action-details {\r\n  margin: 10px 0;\r\n  font-size: 0.9em;\r\n}\r\n\r\n.detail-item {\r\n  margin: 5px 0;\r\n}\r\n\r\n.detail-label {\r\n  font-weight: 500;\r\n  color: #666;\r\n}\r\n\r\n.action-meta {\r\n  margin-top: 10px;\r\n  display: flex;\r\n  gap: 15px;\r\n  font-size: 0.85em;\r\n  color: #666;\r\n}\r\n\r\n.meta-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 5px;\r\n}\r\n\r\n/* Classes pour les différentes actions */\r\n.action-connexion {\r\n  color: #4a6fa5;\r\n  background-color: rgba(74, 111, 165, 0.1);\r\n}\r\n\r\n.action-deconnexion {\r\n  color: #6c757d;\r\n  background-color: rgba(108, 117, 125, 0.1);\r\n}\r\n\r\n.action-creation {\r\n  color: #28a745;\r\n  background-color: rgba(40, 167, 69, 0.1);\r\n}\r\n\r\n.action-modification {\r\n  color: #17a2b8;\r\n  background-color: rgba(23, 162, 184, 0.1);\r\n}\r\n\r\n.action-suppression {\r\n  color: #dc3545;\r\n  background-color: rgba(220, 53, 69, 0.1);\r\n}\r\n\r\n.action-ajout, .action-points {\r\n  color: #ffc107;\r\n  background-color: rgba(255, 193, 7, 0.1);\r\n}\r\n\r\n.action-retrait {\r\n  color: #fd7e14;\r\n  background-color: rgba(253, 126, 20, 0.1);\r\n}\r\n\r\n.action-validation {\r\n  color: #20c997;\r\n  background-color: rgba(32, 201, 151, 0.1);\r\n}\r\n\r\n.action-notation {\r\n  color: #6f42c1;\r\n  background-color: rgba(111, 66, 193, 0.1);\r\n}\r\n\r\n.action-commentaire {\r\n  color: #007bff;\r\n  background-color: rgba(0, 123, 255, 0.1);\r\n}\r\n\r\n.action-utilisation {\r\n  color: #6610f2;\r\n  background-color: rgba(102, 16, 242, 0.1);\r\n}\r\n\r\n.pagination {\r\n  margin-top: 20px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 20px;\r\n}\r\n\r\n.page-btn {\r\n  padding: 8px 16px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  background-color: #2c5038;\r\n  color: white;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.page-btn:disabled {\r\n  background-color: #ccc;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.page-info {\r\n  color: #666;\r\n}\r\n\r\n/* Animation pour l'expansion */\r\n.timeline-container {\r\n  transition: all 0.3s ease-in-out;\r\n}\r\n\r\n@media (max-width: 900px) {\r\n  .filters-container {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n    gap: 10px;\r\n  }\r\n  .search-box, .family-filter, .category-filter {\r\n    width: 100%;\r\n    min-width: 0;\r\n  }\r\n}\r\n\r\n.no-results {\r\n  background-color: white;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  text-align: center;\r\n  margin: 20px 0;\r\n  color: #666;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.filtered-indication {\r\n  font-size: 0.8rem;\r\n  font-style: italic;\r\n  color: #666;\r\n}\r\n\r\n.error-message {\r\n  background: #ffe4e6;\r\n  color: #b91c1c;\r\n  border: 1px solid #fca5a5;\r\n  padding: 12px 18px;\r\n  border-radius: 8px;\r\n  margin-bottom: 18px;\r\n  font-weight: 600;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  font-size: 1.1rem;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}