{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"profile-page\"\n};\nconst _hoisted_2 = {\n  class: \"section\"\n};\nconst _hoisted_3 = {\n  class: \"section\"\n};\nconst _hoisted_4 = {\n  class: \"section\"\n};\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n  class: \"section\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"AppLayout\"], null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_cache[14] || (_cache[14] = _createElementVNode(\"h2\", null, \"üë§ Mon Profil\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_cache[12] || (_cache[12] = _createElementVNode(\"h3\", null, \"üßæ Infos publiques\", -1 /* HOISTED */)), _createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Pseudo :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.login), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Age :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.personne?.age || 'Non sp√©cifi√©'), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"Genre :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.personne?.genre || 'Non sp√©cifi√©'), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"Date de naissance :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.personne?.dateNaissance?.substring(0, 10) || 'Non sp√©cifi√©e'), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \"Type de membre :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.personne?.typeMembre || 'Non pr√©cis√©'), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_3, [_cache[10] || (_cache[10] = _createElementVNode(\"h3\", null, \"üîê Infos priv√©es\", -1 /* HOISTED */)), _createElementVNode(\"p\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \"Nom :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.personne?.nom || 'Non renseign√©'), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \"Pr√©nom :\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.user?.personne?.prenom || 'Non renseign√©'), 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_4, [_cache[11] || (_cache[11] = _createElementVNode(\"h3\", null, \"üñºÔ∏è Photo de profil\", -1 /* HOISTED */)), _createElementVNode(\"img\", {\n      src: $setup.getPhotoUrl($setup.user?.photo),\n      alt: \"Photo de profil\",\n      class: \"avatar\"\n    }, null, 8 /* PROPS */, _hoisted_5), _createElementVNode(\"input\", {\n      type: \"file\",\n      accept: \".png, .jpeg, .jpg\",\n      onChange: $setup.handlePhotoChange\n    }, null, 32 /* NEED_HYDRATION */), $setup.photoPreview ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      src: $setup.photoPreview,\n      alt: \"Preview\",\n      class: \"preview\"\n    }, null, 8 /* PROPS */, _hoisted_6)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n      class: \"btn\",\n      onClick: $setup.uploadPhoto\n    }, \"Mettre √† jour la photo\")])]), _createElementVNode(\"div\", _hoisted_7, [_cache[13] || (_cache[13] = _createElementVNode(\"h3\", null, \"üîí Changer le mot de passe\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.oldPassword = $event),\n      type: \"password\",\n      placeholder: \"Ancien mot de passe\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.oldPassword]]), _withDirectives(_createElementVNode(\"input\", {\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.newPassword = $event),\n      type: \"password\",\n      placeholder: \"Nouveau mot de passe\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.newPassword]]), _withDirectives(_createElementVNode(\"input\", {\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.confirmPassword = $event),\n      type: \"password\",\n      placeholder: \"Confirmer le nouveau mot de passe\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.confirmPassword]]), _createElementVNode(\"button\", {\n      class: \"btn\",\n      onClick: $setup.updatePassword\n    }, \"Mettre √† jour le mot de passe\")])])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","_createBlock","$setup","default","_withCtx","_createElementVNode","_hoisted_1","_hoisted_2","_createTextVNode","_toDisplayString","user","login","personne","age","genre","dateNaissance","substring","typeMembre","_hoisted_3","nom","prenom","_hoisted_4","src","getPhotoUrl","photo","alt","_hoisted_5","type","accept","onChange","handlePhotoChange","photoPreview","_createElementBlock","key","_hoisted_6","_createCommentVNode","onClick","uploadPhoto","_hoisted_7","_cache","$event","oldPassword","placeholder","newPassword","confirmPassword","updatePassword","_"],"sources":["C:\\Users\\benab\\Desktop\\COURS 24_25\\S2\\WEB\\V4\\Projet_WEB_ING1\\frontend\\src\\views\\ProfileView.vue"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport AppLayout from '@/layout/AppLayoutGlobal.vue'\r\nimport api from '@/services/api'\r\nimport { getPhotoUrl } from '@/utils/photo'\r\n\r\nconst user = ref(null)\r\nconst oldPassword = ref('')\r\nconst newPassword = ref('')\r\nconst confirmPassword = ref('')\r\nconst photoFile = ref(null)\r\nconst photoPreview = ref(null)\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const res = await api.get('/users/me')\r\n    user.value = res.data\r\n  } catch (err) {\r\n    console.error('Erreur chargement profil :', err)\r\n  }\r\n})\r\n\r\nconst handlePhotoChange = (e) => {\r\n  const file = e.target.files[0]\r\n  if (!file) return\r\n  if (!['image/png', 'image/jpeg'].includes(file.type)) {\r\n    alert('Seuls les formats PNG et JPEG sont accept√©s.')\r\n    return\r\n  }\r\n  photoFile.value = file\r\n  photoPreview.value = URL.createObjectURL(file)\r\n}\r\n\r\nconst uploadPhoto = async () => {\r\n  if (!photoFile.value) {\r\n    alert(\"Veuillez choisir une image.\")\r\n    return\r\n  }\r\n\r\n  const formData = new FormData()\r\n  formData.append('photo', photoFile.value)\r\n\r\n  try {\r\n    const res = await api.put('/users/me/photo', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    })\r\n    alert(\"Photo mise √† jour !\")\r\n    user.value.photo = res.data.photo\r\n    photoPreview.value = null\r\n    photoFile.value = null\r\n  } catch (err) {\r\n    alert(\"Erreur lors de l'envoi de la photo\")\r\n    console.error(err)\r\n  }\r\n}\r\n\r\n\r\nconst updatePassword = async () => {\r\n  if (!oldPassword.value || !newPassword.value || !confirmPassword.value) {\r\n    alert('Tous les champs sont obligatoires.')\r\n    return\r\n  }\r\n  if (newPassword.value !== confirmPassword.value) {\r\n    alert('Les mots de passe ne correspondent pas.')\r\n    return\r\n  }\r\n  try {\r\n    await api.put('/users/me', {\r\n      password: newPassword.value,\r\n      oldPassword: oldPassword.value\r\n    })\r\n    alert('Mot de passe mis √† jour')\r\n    oldPassword.value = ''\r\n    newPassword.value = ''\r\n    confirmPassword.value = ''\r\n  } catch (err) {\r\n    alert(\"Erreur lors de la mise √† jour : \" + (err.response?.data?.message || 'Inconnue'))\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <AppLayout>\r\n    <div class=\"profile-page\">\r\n      <h2>üë§ Mon Profil</h2>\r\n\r\n\r\n\r\n      <div class=\"section\">\r\n        <h3>üßæ Infos publiques</h3>\r\n        <p><strong>Pseudo :</strong> {{ user?.login }}</p>\r\n        <p><strong>Age :</strong> {{ user?.personne?.age || 'Non sp√©cifi√©' }}</p>\r\n        <p><strong>Genre :</strong> {{ user?.personne?.genre || 'Non sp√©cifi√©' }}</p>\r\n        <p><strong>Date de naissance :</strong> {{ user?.personne?.dateNaissance?.substring(0, 10) || 'Non sp√©cifi√©e' }}</p>\r\n        <p><strong>Type de membre :</strong> {{ user?.personne?.typeMembre || 'Non pr√©cis√©' }}</p>\r\n        <div class=\"section\">\r\n          <h3>üîê Infos priv√©es</h3>\r\n          <p><strong>Nom :</strong> {{ user?.personne?.nom || 'Non renseign√©' }}</p>\r\n          <p><strong>Pr√©nom :</strong> {{ user?.personne?.prenom || 'Non renseign√©' }}</p>\r\n        </div>\r\n\r\n        <div class=\"section\">\r\n          <h3>üñºÔ∏è Photo de profil</h3>\r\n\r\n          <img\r\n              :src=\"getPhotoUrl(user?.photo)\"\r\n              alt=\"Photo de profil\"\r\n              class=\"avatar\"\r\n          />\r\n\r\n          <input type=\"file\" accept=\".png, .jpeg, .jpg\" @change=\"handlePhotoChange\" />\r\n          <img v-if=\"photoPreview\" :src=\"photoPreview\" alt=\"Preview\" class=\"preview\" />\r\n          <button class=\"btn\" @click=\"uploadPhoto\">Mettre √† jour la photo</button>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"section\">\r\n        <h3>üîí Changer le mot de passe</h3>\r\n        <input v-model=\"oldPassword\" type=\"password\" placeholder=\"Ancien mot de passe\" />\r\n        <input v-model=\"newPassword\" type=\"password\" placeholder=\"Nouveau mot de passe\" />\r\n        <input v-model=\"confirmPassword\" type=\"password\" placeholder=\"Confirmer le nouveau mot de passe\" />\r\n        <button class=\"btn\" @click=\"updatePassword\">Mettre √† jour le mot de passe</button>\r\n      </div>\r\n    </div>\r\n  </AppLayout>\r\n</template>\r\n\r\n<style scoped>\r\n.profile-page {\r\n  padding: 2rem;\r\n  max-width: 600px;\r\n  margin: auto;\r\n}\r\n.section {\r\n  background: #f8f8f8;\r\n  padding: 1.5rem;\r\n  border-radius: 8px;\r\n  margin-bottom: 2rem;\r\n}\r\n.preview {\r\n  width: 100px;\r\n  margin-top: 1rem;\r\n  border-radius: 6px;\r\n}\r\ninput {\r\n  display: block;\r\n  margin: 0.5rem 0;\r\n  padding: 0.5rem;\r\n  width: 100%;\r\n  border-radius: 4px;\r\n  border: 1px solid #ccc;\r\n}\r\nbutton.btn {\r\n  margin-top: 1rem;\r\n  padding: 0.5rem 1rem;\r\n  background-color: #2c3e50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n.avatar {\r\n  width: 120px;\r\n  height: 120px;\r\n  object-fit: cover;\r\n  border-radius: 50%;\r\n  margin-bottom: 1rem;\r\n  border: 2px solid #ccc;\r\n}\r\n\r\n</style>\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}