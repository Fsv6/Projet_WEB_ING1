{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"login-card\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nconst _hoisted_6 = [\"disabled\"];\nconst _hoisted_7 = [\"disabled\"];\nconst _hoisted_8 = {\n  key: 0,\n  class: \"loading-spinner\"\n};\nconst _hoisted_9 = {\n  class: \"register-link\"\n};\nconst _hoisted_10 = {\n  class: \"register-link\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n    class: \"login-image left\"\n  }, [_createCommentVNode(\"<img src=\\\"@/assets/kitchen-left.jpg\\\" alt=\\\"Cuisine design\\\">\")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_cache[7] || (_cache[7] = _createElementVNode(\"h2\", null, [_createTextVNode(\"Bienvenue dans\"), _createElementVNode(\"br\"), _createTextVNode(\"MaCuisineConnect√©e\")], -1 /* HOISTED */)), $data.message ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: _normalizeClass(['alert', $data.message.type === 'success' ? 'alert-success' : 'alert-error'])\n  }, _toDisplayString($data.message.text), 3 /* TEXT, CLASS */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"form\", {\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers((...args) => $options.handleLogin && $options.handleLogin(...args), [\"prevent\"])),\n    class: \"login-form\"\n  }, [_createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    id: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    required: \"\",\n    placeholder: \"Email\",\n    disabled: $data.loading\n  }, null, 8 /* PROPS */, _hoisted_4), [[_vModelText, $data.email]])]), _createElementVNode(\"div\", _hoisted_5, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    id: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.password = $event),\n    required: \"\",\n    placeholder: \"Mot de passe\",\n    disabled: $data.loading\n  }, null, 8 /* PROPS */, _hoisted_6), [[_vModelText, $data.password]])]), _createElementVNode(\"button\", {\n    type: \"submit\",\n    disabled: $data.loading,\n    class: \"submit-btn\"\n  }, [$data.loading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8)) : _createCommentVNode(\"v-if\", true), _createTextVNode(\" \" + _toDisplayString($data.loading ? 'Connexion en cours...' : 'Se connecter'), 1 /* TEXT */)], 8 /* PROPS */, _hoisted_7), _createElementVNode(\"p\", _hoisted_9, [_cache[4] || (_cache[4] = _createTextVNode(\" Pas encore de compte ? \")), _createVNode(_component_router_link, {\n    to: \"/register\",\n    class: _normalizeClass({\n      'disabled': $data.loading\n    })\n  }, {\n    default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\"S'inscrire\")])),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"class\"])]), _createElementVNode(\"p\", _hoisted_10, [_cache[6] || (_cache[6] = _createTextVNode(\" Espace Visiteurs ‚Äì \")), _createVNode(_component_router_link, {\n    to: \"/explore\",\n    onClick: _withModifiers($options.activerModeVisiteur, [\"prevent\"])\n  }, {\n    default: _withCtx(() => _cache[5] || (_cache[5] = [_createTextVNode(\"Y acc√©der\")])),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])], 32 /* NEED_HYDRATION */)]), _cache[9] || (_cache[9] = _createElementVNode(\"div\", {\n    class: \"login-image right\"\n  }, [_createCommentVNode(\"<img src=\\\"@/assets/kitchen-right.jpg\\\" alt=\\\"Plats cuisin√©s\\\">\")], -1 /* HOISTED */))]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","_hoisted_2","_createTextVNode","$data","message","_normalizeClass","type","text","onSubmit","_cache","_withModifiers","args","$options","handleLogin","_hoisted_3","id","$event","email","required","placeholder","disabled","loading","_hoisted_4","_hoisted_5","password","_hoisted_6","_hoisted_8","_toDisplayString","_hoisted_7","_hoisted_9","_createVNode","_component_router_link","to","default","_withCtx","_","_hoisted_10","onClick","activerModeVisiteur"],"sources":["C:\\Users\\benab\\Desktop\\COURS 24_25\\S2\\WEB\\V4\\Projet_WEB_ING1\\frontend\\src\\views\\Login.vue"],"sourcesContent":["\r\n<template>\r\n  <div class=\"login-container\">\r\n    <div class=\"login-image left\">\r\n      <!--<img src=\"@/assets/kitchen-left.jpg\" alt=\"Cuisine design\">-->\r\n    </div>\r\n    <div class=\"login-card\">\r\n      <h2>Bienvenue dans<br>MaCuisineConnect√©e</h2>\r\n      \r\n      <div v-if=\"message\" :class=\"['alert', message.type === 'success' ? 'alert-success' : 'alert-error']\">\r\n        {{ message.text }}\r\n      </div>\r\n\r\n      <form @submit.prevent=\"handleLogin\" class=\"login-form\">\r\n        <div class=\"form-group\">\r\n          <input \r\n            type=\"email\" \r\n            id=\"email\" \r\n            v-model=\"email\" \r\n            required\r\n            placeholder=\"Email\"\r\n            :disabled=\"loading\"\r\n          >\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <input \r\n            type=\"password\" \r\n            id=\"password\" \r\n            v-model=\"password\" \r\n            required\r\n            placeholder=\"Mot de passe\"\r\n            :disabled=\"loading\"\r\n          >\r\n        </div>\r\n\r\n        <button type=\"submit\" :disabled=\"loading\" class=\"submit-btn\">\r\n          <span v-if=\"loading\" class=\"loading-spinner\"></span>\r\n          {{ loading ? 'Connexion en cours...' : 'Se connecter' }}\r\n        </button>\r\n\r\n        <p class=\"register-link\">\r\n          Pas encore de compte ? \r\n          <router-link to=\"/register\" :class=\"{ 'disabled': loading }\">S'inscrire</router-link>\r\n        </p>\r\n        <p class=\"register-link\">\r\n          Espace Visiteurs ‚Äì\r\n          <router-link to=\"/explore\" @click.prevent=\"activerModeVisiteur\">Y acc√©der</router-link>\r\n\r\n        </p>\r\n\r\n      </form>\r\n    </div>\r\n    <div class=\"login-image right\">\r\n      <!--<img src=\"@/assets/kitchen-right.jpg\" alt=\"Plats cuisin√©s\">-->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport authService from '../services/authService';\r\nimport { useAuthStore } from '../stores/auth'\r\nimport api from \"../services/api\";\r\n\r\n\r\nexport default {\r\n  name: 'LoginPage',\r\n  data() {\r\n    return {\r\n      email: '',\r\n      password: '',\r\n      loading: false,\r\n      message: null\r\n    };\r\n  },\r\n  methods: {\r\n\r\n    activerModeVisiteur() {\r\n      const auth = useAuthStore()\r\n      auth.setAsVisitor()\r\n      this.$router.push('/explore')\r\n    },\r\n\r\n\r\n    async handleLogin() {\r\n      if (this.loading) return;\r\n\r\n      this.loading = true;\r\n      this.message = null;\r\n\r\n      try {\r\n        const response = await authService.login(this.email, this.password);\r\n        const authStore = useAuthStore(); // üî• ICI on initialise Pinia\r\n\r\n        this.message = {\r\n          type: 'success',\r\n          text: 'Connexion r√©ussie ! Redirection...'\r\n        };\r\n\r\n        // Stockage local\r\n        localStorage.setItem('token', response.token);\r\n        localStorage.setItem('user', JSON.stringify(response.user));\r\n\r\n        // üîê M√†J du store Pinia (indispensable pour ExploreApp.vue)\r\n        authStore.setAuth(response.user);\r\n\r\n        // Ajout de points √† la connexion\r\n        try {\r\n          await api.post(`/users/${response.user._id}/points`, { amount: 0.25 });\r\n          authStore.points += 0.25; // met √† jour le store local aussi\r\n          localStorage.setItem('points', authStore.points);\r\n        } catch (err) {\r\n          console.warn(\"Erreur lors de l'ajout de points √† la connexion\", err);\r\n        }\r\n\r\n\r\n        setTimeout(() => {\r\n          if (response.user.role === 'admin') {\r\n            this.$router.push('/admin');\r\n          } else {\r\n            this.$router.push('/dashboard');\r\n          }\r\n        }, 1500);\r\n\r\n      } catch (error) {\r\n        console.error('Erreur de connexion :', error);\r\n        this.message = {\r\n          type: 'error',\r\n          text: error.response?.data?.message || \"Erreur inconnue\"\r\n        };\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    }\r\n\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background-color: #e8f4f8;\r\n  padding: 0;\r\n  gap: 20px;\r\n}\r\n\r\n.login-image {\r\n  height: 85vh;\r\n  width: 200px;\r\n  overflow: hidden;\r\n  display: none;\r\n  border-radius: 30px;\r\n}\r\n\r\n.login-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n  \r\n}\r\n\r\n.login-card {\r\n  background: white;\r\n  padding: 30px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  width: 100%;\r\n  max-width: 400px;\r\n}\r\n\r\nh2 {\r\n  text-align: center;\r\n  color: #006d77;\r\n  margin-bottom: 30px;\r\n  font-size: 1.8rem;\r\n  line-height: 1.3;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  box-sizing: border-box;\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #006d77;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #3aa876;\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: #a8a8a8;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.register-link {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.register-link a {\r\n  color: #42b983;\r\n  text-decoration: none;\r\n}\r\n\r\n.alert {\r\n  padding: 12px;\r\n  border-radius: 4px;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.alert-success {\r\n  background-color: #d4edda;\r\n  color: #155724;\r\n  border: 1px solid #c3e6cb;\r\n}\r\n\r\n.alert-error {\r\n  background-color: #f8d7da;\r\n  color: #721c24;\r\n  border: 1px solid #f5c6cb;\r\n}\r\n\r\n/* Media Queries */\r\n@media screen and (min-width: 1200px) {\r\n  .login-image {\r\n    display: block;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .login-container {\r\n    padding: 15px;\r\n  }\r\n  .login-card {\r\n    padding: 25px;\r\n  }\r\n  h2 {\r\n    font-size: 1.75rem;\r\n    margin-bottom: 25px;\r\n  }\r\n  input {\r\n    padding: 10px;\r\n    font-size: 14px;\r\n  }\r\n  button {\r\n    padding: 10px;\r\n    font-size: 14px;\r\n  }\r\n}\r\n@media screen and (max-width: 480px) {\r\n  .login-container {\r\n    padding: 10px;\r\n  }\r\n  .login-card {\r\n    padding: 20px;\r\n  }\r\n  h2 {\r\n    font-size: 1.5rem;\r\n    margin-bottom: 20px;\r\n  }\r\n  .form-group {\r\n    margin-bottom: 15px;\r\n  }\r\n  label {\r\n    font-size: 0.9rem;\r\n  }\r\n  input {\r\n    padding: 8px;\r\n    font-size: 13px;\r\n  }\r\n  button {\r\n    padding: 8px;\r\n    font-size: 13px;\r\n  }\r\n  .register-link {\r\n    font-size: 0.8rem;\r\n  }\r\n  .alert {\r\n    padding: 10px;\r\n    font-size: 0.8rem;\r\n  }\r\n}\r\n\r\n.submit-btn {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 8px;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 16px;\r\n  height: 16px;\r\n  border: 2px solid #ffffff;\r\n  border-top: 2px solid transparent;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.disabled {\r\n  pointer-events: none;\r\n  opacity: 0.7;\r\n}\r\n\r\ninput:disabled {\r\n  background-color: #f5f5f5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.alert {\r\n  animation: slideDown 0.3s ease-out;\r\n}\r\n\r\n@keyframes slideDown {\r\n  from {\r\n    transform: translateY(-10px);\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    transform: translateY(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}