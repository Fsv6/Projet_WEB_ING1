{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, vModelSelect as _vModelSelect, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withModifiers as _withModifiers, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"points-management-container\"\n};\nconst _hoisted_2 = {\n  class: \"filters-container\"\n};\nconst _hoisted_3 = {\n  class: \"search-box\"\n};\nconst _hoisted_4 = {\n  class: \"filter-options\"\n};\nconst _hoisted_5 = {\n  class: \"sort-option\"\n};\nconst _hoisted_6 = {\n  class: \"users-table-container\"\n};\nconst _hoisted_7 = {\n  class: \"users-table\"\n};\nconst _hoisted_8 = {\n  class: \"user-info\"\n};\nconst _hoisted_9 = [\"src\"];\nconst _hoisted_10 = {\n  class: \"user-details\"\n};\nconst _hoisted_11 = {\n  class: \"user-name\"\n};\nconst _hoisted_12 = {\n  class: \"user-email\"\n};\nconst _hoisted_13 = {\n  class: \"points-column\"\n};\nconst _hoisted_14 = {\n  class: \"points-badge\"\n};\nconst _hoisted_15 = {\n  class: \"actions-column\"\n};\nconst _hoisted_16 = [\"onClick\"];\nconst _hoisted_17 = {\n  key: 0,\n  class: \"pagination\"\n};\nconst _hoisted_18 = [\"disabled\"];\nconst _hoisted_19 = {\n  class: \"page-info\"\n};\nconst _hoisted_20 = [\"disabled\"];\nconst _hoisted_21 = {\n  class: \"modal-header\"\n};\nconst _hoisted_22 = {\n  class: \"modal-body\"\n};\nconst _hoisted_23 = {\n  class: \"points-info\"\n};\nconst _hoisted_24 = {\n  class: \"points-form\"\n};\nconst _hoisted_25 = {\n  class: \"form-group\"\n};\nconst _hoisted_26 = {\n  class: \"form-group\"\n};\nconst _hoisted_27 = {\n  class: \"modal-footer\"\n};\nconst _hoisted_28 = [\"disabled\"];\nconst _hoisted_29 = {\n  key: 0\n};\nconst _hoisted_30 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_AppLayout = _resolveComponent(\"AppLayout\");\n  return _openBlock(), _createBlock(_component_AppLayout, null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_cache[24] || (_cache[24] = _createElementVNode(\"h1\", {\n      class: \"page-title\"\n    }, \"Supervision des points utilisateurs\", -1 /* HOISTED */)), _createCommentVNode(\" Filtres \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_withDirectives(_createElementVNode(\"input\", {\n      type: \"text\",\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchTerm = $event),\n      placeholder: \"Rechercher un utilisateur...\",\n      onInput: _cache[1] || (_cache[1] = (...args) => $setup.debounceSearch && $setup.debounceSearch(...args))\n    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $setup.searchTerm]]), _cache[13] || (_cache[13] = _createElementVNode(\"i\", {\n      class: \"fas fa-search search-icon\"\n    }, null, -1 /* HOISTED */))]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_cache[15] || (_cache[15] = _createElementVNode(\"label\", {\n      for: \"sort-by\"\n    }, \"Trier par:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n      id: \"sort-by\",\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.sortBy = $event),\n      onChange: _cache[3] || (_cache[3] = (...args) => $setup.applyFilters && $setup.applyFilters(...args))\n    }, _cache[14] || (_cache[14] = [_createElementVNode(\"option\", {\n      value: \"points-desc\"\n    }, \"Points (décroissant)\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n      value: \"points-asc\"\n    }, \"Points (croissant)\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n      value: \"nom\"\n    }, \"Nom\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n      value: \"date\"\n    }, \"Date de dernière activité\", -1 /* HOISTED */)]), 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelSelect, $setup.sortBy]])])])]), _createCommentVNode(\" Tableau des utilisateurs et leurs points \"), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"table\", _hoisted_7, [_cache[17] || (_cache[17] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Utilisateur\"), _createElementVNode(\"th\", null, \"Points\"), _createElementVNode(\"th\", null, \"Niveau\"), _createElementVNode(\"th\", null, \"Dernière activité\"), _createElementVNode(\"th\", null, \"Actions\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.displayedUsers, user => {\n      return _openBlock(), _createElementBlock(\"tr\", {\n        key: user._id\n      }, [_createElementVNode(\"td\", _hoisted_8, [_createElementVNode(\"img\", {\n        src: $setup.getPhotoUrl(user.photo, user._id),\n        class: \"user-avatar\",\n        alt: \"Avatar\"\n      }, null, 8 /* PROPS */, _hoisted_9), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, _toDisplayString(user.personne?.nom) + \" \" + _toDisplayString(user.personne?.prenom), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_12, _toDisplayString(user.email), 1 /* TEXT */)])]), _createElementVNode(\"td\", _hoisted_13, [_createElementVNode(\"span\", _hoisted_14, _toDisplayString(user.points), 1 /* TEXT */)]), _createElementVNode(\"td\", null, _toDisplayString(user.niveau), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($setup.formatLastActivity(user.lastActivity)), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_15, [_createElementVNode(\"button\", {\n        class: \"btn edit-points\",\n        onClick: $event => $setup.openAddPointsModal(user)\n      }, [...(_cache[16] || (_cache[16] = [_createElementVNode(\"i\", {\n        class: \"fas fa-plus-circle\"\n      }, null, -1 /* HOISTED */), _createTextVNode(\" Ajuster \")]))], 8 /* PROPS */, _hoisted_16)])]);\n    }), 128 /* KEYED_FRAGMENT */))])])]), _createCommentVNode(\" Pagination \"), $setup.totalPages > 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [_createElementVNode(\"button\", {\n      disabled: $setup.currentPage === 1,\n      onClick: _cache[4] || (_cache[4] = $event => $setup.changePage($setup.currentPage - 1)),\n      class: \"page-btn\"\n    }, _cache[18] || (_cache[18] = [_createElementVNode(\"i\", {\n      class: \"fas fa-chevron-left\"\n    }, null, -1 /* HOISTED */), _createTextVNode(\" Précédent \")]), 8 /* PROPS */, _hoisted_18), _createElementVNode(\"span\", _hoisted_19, \"Page \" + _toDisplayString($setup.currentPage) + \" sur \" + _toDisplayString($setup.totalPages), 1 /* TEXT */), _createElementVNode(\"button\", {\n      disabled: $setup.currentPage === $setup.totalPages,\n      onClick: _cache[5] || (_cache[5] = $event => $setup.changePage($setup.currentPage + 1)),\n      class: \"page-btn\"\n    }, _cache[19] || (_cache[19] = [_createTextVNode(\" Suivant \"), _createElementVNode(\"i\", {\n      class: \"fas fa-chevron-right\"\n    }, null, -1 /* HOISTED */)]), 8 /* PROPS */, _hoisted_20)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Modal pour ajouter/retirer des points \"), $setup.showPointsModal ? (_openBlock(), _createElementBlock(\"div\", {\n      key: 1,\n      class: \"modal-overlay\",\n      onClick: _cache[12] || (_cache[12] = (...args) => $setup.closePointsModal && $setup.closePointsModal(...args))\n    }, [_createElementVNode(\"div\", {\n      class: \"modal-content\",\n      onClick: _cache[11] || (_cache[11] = _withModifiers(() => {}, [\"stop\"]))\n    }, [_createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"h2\", null, \"Ajuster les points - \" + _toDisplayString($setup.selectedUser.email), 1 /* TEXT */), _createElementVNode(\"button\", {\n      class: \"close-button\",\n      onClick: _cache[6] || (_cache[6] = (...args) => $setup.closePointsModal && $setup.closePointsModal(...args))\n    }, _cache[20] || (_cache[20] = [_createElementVNode(\"i\", {\n      class: \"fas fa-times\"\n    }, null, -1 /* HOISTED */)]))]), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"div\", _hoisted_23, [_createElementVNode(\"p\", null, [_cache[21] || (_cache[21] = _createTextVNode(\"Points actuels: \")), _createElementVNode(\"strong\", null, _toDisplayString($setup.selectedUser.points), 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_24, [_createElementVNode(\"div\", _hoisted_25, [_cache[22] || (_cache[22] = _createElementVNode(\"label\", {\n      for: \"points-amount\"\n    }, \"Montant des points:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n      type: \"number\",\n      id: \"points-amount\",\n      \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => $setup.pointsAmount = $event),\n      step: \"0.5\",\n      placeholder: \"Entrez un nombre positif ou négatif\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.pointsAmount]])]), _createElementVNode(\"div\", _hoisted_26, [_cache[23] || (_cache[23] = _createElementVNode(\"label\", {\n      for: \"points-reason\"\n    }, \"Raison:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n      type: \"text\",\n      id: \"points-reason\",\n      \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => $setup.pointsReason = $event),\n      placeholder: \"Ex: Aziz a été sage !\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.pointsReason]])])])]), _createElementVNode(\"div\", _hoisted_27, [_createElementVNode(\"button\", {\n      class: \"btn cancel\",\n      onClick: _cache[9] || (_cache[9] = (...args) => $setup.closePointsModal && $setup.closePointsModal(...args))\n    }, \"Annuler\"), _createElementVNode(\"button\", {\n      class: \"btn confirm\",\n      onClick: _cache[10] || (_cache[10] = (...args) => $setup.confirmPointsAdjustment && $setup.confirmPointsAdjustment(...args)),\n      disabled: !$setup.pointsAmount || $setup.loading\n    }, [$setup.loading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_29, \"Traitement...\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_30, \"Confirmer\"))], 8 /* PROPS */, _hoisted_28)])])])) : _createCommentVNode(\"v-if\", true)])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","key","_createBlock","_component_AppLayout","default","_withCtx","_createElementVNode","_hoisted_1","_createCommentVNode","_hoisted_2","_hoisted_3","type","_cache","$event","$setup","searchTerm","placeholder","onInput","args","debounceSearch","_hoisted_4","_hoisted_5","for","id","sortBy","onChange","applyFilters","value","_hoisted_6","_hoisted_7","_createElementBlock","_Fragment","_renderList","displayedUsers","user","_id","_hoisted_8","src","getPhotoUrl","photo","alt","_hoisted_9","_hoisted_10","_hoisted_11","_toDisplayString","personne","nom","prenom","_hoisted_12","email","_hoisted_13","_hoisted_14","points","niveau","formatLastActivity","lastActivity","_hoisted_15","onClick","openAddPointsModal","_createTextVNode","_hoisted_16","totalPages","_hoisted_17","disabled","currentPage","changePage","_hoisted_18","_hoisted_19","_hoisted_20","showPointsModal","closePointsModal","_withModifiers","_hoisted_21","selectedUser","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","pointsAmount","step","_hoisted_26","pointsReason","_hoisted_27","confirmPointsAdjustment","loading","_hoisted_29","_hoisted_30","_hoisted_28","_"],"sources":["C:\\Users\\benab\\Desktop\\COURS 24_25\\S2\\WEB\\V4\\Projet_WEB_ING1\\frontend\\src\\views\\AdminUserPoints.vue"],"sourcesContent":["<template>\r\n  <AppLayout>\r\n    <div class=\"points-management-container\">\r\n      <h1 class=\"page-title\">Supervision des points utilisateurs</h1>\r\n\r\n      <!-- Filtres -->\r\n      <div class=\"filters-container\">\r\n        <div class=\"search-box\">\r\n          <input\r\n              type=\"text\"\r\n              v-model=\"searchTerm\"\r\n              placeholder=\"Rechercher un utilisateur...\"\r\n              @input=\"debounceSearch\"\r\n          />\r\n          <i class=\"fas fa-search search-icon\"></i>\r\n        </div>\r\n\r\n        <div class=\"filter-options\">\r\n          <div class=\"sort-option\">\r\n            <label for=\"sort-by\">Trier par:</label>\r\n            <select id=\"sort-by\" v-model=\"sortBy\" @change=\"applyFilters\">\r\n              <option value=\"points-desc\">Points (décroissant)</option>\r\n              <option value=\"points-asc\">Points (croissant)</option>\r\n              <option value=\"nom\">Nom</option>\r\n              <option value=\"date\">Date de dernière activité</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Tableau des utilisateurs et leurs points -->\r\n      <div class=\"users-table-container\">\r\n        <table class=\"users-table\">\r\n          <thead>\r\n          <tr>\r\n            <th>Utilisateur</th>\r\n            <th>Points</th>\r\n            <th>Niveau</th>\r\n            <th>Dernière activité</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n          </thead>\r\n          <tbody>\r\n          <tr v-for=\"user in displayedUsers\" :key=\"user._id\">\r\n            <td class=\"user-info\">\r\n              <img :src=\"getPhotoUrl(user.photo, user._id)\" class=\"user-avatar\" alt=\"Avatar\">\r\n              <div class=\"user-details\">\r\n                <div class=\"user-name\">{{ user.personne?.nom }} {{ user.personne?.prenom }}</div>\r\n                <div class=\"user-email\">{{ user.email }}</div>\r\n              </div>\r\n            </td>\r\n            <td class=\"points-column\">\r\n              <span class=\"points-badge\">{{ user.points }}</span>\r\n            </td>\r\n            <td>{{ user.niveau }}</td>\r\n            <td>{{ formatLastActivity(user.lastActivity) }}</td>\r\n            <td class=\"actions-column\">\r\n\r\n              <button class=\"btn edit-points\" @click=\"openAddPointsModal(user)\">\r\n                <i class=\"fas fa-plus-circle\"></i> Ajuster\r\n              </button>\r\n            </td>\r\n          </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- Pagination -->\r\n      <div class=\"pagination\" v-if=\"totalPages > 1\">\r\n        <button\r\n            :disabled=\"currentPage === 1\"\r\n            @click=\"changePage(currentPage - 1)\"\r\n            class=\"page-btn\"\r\n        >\r\n          <i class=\"fas fa-chevron-left\"></i> Précédent\r\n        </button>\r\n        <span class=\"page-info\">Page {{ currentPage }} sur {{ totalPages }}</span>\r\n        <button\r\n            :disabled=\"currentPage === totalPages\"\r\n            @click=\"changePage(currentPage + 1)\"\r\n            class=\"page-btn\"\r\n        >\r\n          Suivant <i class=\"fas fa-chevron-right\"></i>\r\n        </button>\r\n      </div>\r\n\r\n      <!-- Modal pour ajouter/retirer des points -->\r\n      <div v-if=\"showPointsModal\" class=\"modal-overlay\" @click=\"closePointsModal\">\r\n        <div class=\"modal-content\" @click.stop>\r\n          <div class=\"modal-header\">\r\n            <h2>Ajuster les points - {{ selectedUser.email }}</h2>\r\n            <button class=\"close-button\" @click=\"closePointsModal\">\r\n              <i class=\"fas fa-times\"></i>\r\n            </button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"points-info\">\r\n              <p>Points actuels: <strong>{{ selectedUser.points }}</strong></p>\r\n            </div>\r\n            <div class=\"points-form\">\r\n              <div class=\"form-group\">\r\n                <label for=\"points-amount\">Montant des points:</label>\r\n                <input\r\n                    type=\"number\"\r\n                    id=\"points-amount\"\r\n                    v-model=\"pointsAmount\"\r\n                    step=\"0.5\"\r\n                    placeholder=\"Entrez un nombre positif ou négatif\"\r\n                />\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label for=\"points-reason\">Raison:</label>\r\n                <input\r\n                    type=\"text\"\r\n                    id=\"points-reason\"\r\n                    v-model=\"pointsReason\"\r\n                    placeholder=\"Ex: Aziz a été sage !\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button class=\"btn cancel\" @click=\"closePointsModal\">Annuler</button>\r\n            <button\r\n                class=\"btn confirm\"\r\n                @click=\"confirmPointsAdjustment\"\r\n                :disabled=\"!pointsAmount || loading\"\r\n            >\r\n              <span v-if=\"loading\">Traitement...</span>\r\n              <span v-else>Confirmer</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </AppLayout>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted, watch } from 'vue';\r\nimport AppLayout from '@/layout/AppLayoutGlobal.vue';\r\nimport api from '@/services/api';\r\nimport defaultAvatar from '@/assets/default-avatar.png';\r\nimport { getPhotoUrl } from '@/utils/photo';\r\n\r\nexport default {\r\n  name: 'AdminUserPoints',\r\n  components: {\r\n    AppLayout\r\n  },\r\n  setup() {\r\n    const users = ref([]);\r\n    const loading = ref(false);\r\n    const searchTerm = ref('');\r\n    const searchTimeout = ref(null);\r\n    const currentPage = ref(1);\r\n    const itemsPerPage = 10;\r\n    const sortBy = ref('points-desc');\r\n\r\n    // Modals\r\n    const showPointsModal = ref(false);\r\n    const selectedUser = ref({});\r\n    const pointsAmount = ref(null);\r\n    const pointsReason = ref('');\r\n\r\n    // Load all users with their points\r\n    const loadUsers = async () => {\r\n      try {\r\n        loading.value = true;\r\n        const response = await api.get('/users');\r\n        users.value = response.data.map(user => ({\r\n          ...user,\r\n          lastActivity: new Date() // Dans un cas réel, il faudrait récupérer cette information\r\n        }));\r\n      } catch (error) {\r\n        console.error('Erreur lors du chargement des utilisateurs:', error);\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    // Filter and sort users\r\n    const filteredUsers = computed(() => {\r\n      if (!users.value) return [];\r\n\r\n      let result = [...users.value];\r\n\r\n      // Apply search filter\r\n      if (searchTerm.value) {\r\n        const search = searchTerm.value.toLowerCase();\r\n        result = result.filter(user =>\r\n            user.email?.toLowerCase().includes(search) ||\r\n            user.personne?.nom?.toLowerCase().includes(search) ||\r\n            user.personne?.prenom?.toLowerCase().includes(search) ||\r\n            user.login?.toLowerCase().includes(search)\r\n        );\r\n      }\r\n\r\n      // Apply sorting\r\n      switch (sortBy.value) {\r\n        case 'points-desc':\r\n          result.sort((a, b) => b.points - a.points);\r\n          break;\r\n        case 'points-asc':\r\n          result.sort((a, b) => a.points - b.points);\r\n          break;\r\n        case 'nom':\r\n          result.sort((a, b) => {\r\n            const nomA = a.personne?.nom || '';\r\n            const nomB = b.personne?.nom || '';\r\n            return nomA.localeCompare(nomB);\r\n          });\r\n          break;\r\n        case 'date':\r\n          result.sort((a, b) => new Date(b.lastActivity) - new Date(a.lastActivity));\r\n          break;\r\n      }\r\n\r\n      return result;\r\n    });\r\n\r\n    // Pagination\r\n    const totalPages = computed(() => {\r\n      return Math.ceil(filteredUsers.value.length / itemsPerPage);\r\n    });\r\n\r\n    const displayedUsers = computed(() => {\r\n      const start = (currentPage.value - 1) * itemsPerPage;\r\n      const end = start + itemsPerPage;\r\n      return filteredUsers.value.slice(start, end);\r\n    });\r\n\r\n    const changePage = (page) => {\r\n      if (page >= 1 && page <= totalPages.value) {\r\n        currentPage.value = page;\r\n      }\r\n    };\r\n\r\n    // Search with debounce\r\n    const debounceSearch = () => {\r\n      if (searchTimeout.value) {\r\n        clearTimeout(searchTimeout.value);\r\n      }\r\n\r\n      searchTimeout.value = setTimeout(() => {\r\n        currentPage.value = 1; // Reset to first page on search\r\n      }, 300);\r\n    };\r\n\r\n    const applyFilters = () => {\r\n      currentPage.value = 1; // Reset to first page when changing filters\r\n    };\r\n\r\n    // Format date for display\r\n    const formatLastActivity = (date) => {\r\n      if (!date) return 'N/A';\r\n      return new Date(date).toLocaleString('fr-FR');\r\n    };\r\n\r\n    // Modal functions\r\n    const openAddPointsModal = (user) => {\r\n      selectedUser.value = user;\r\n      pointsAmount.value = null;\r\n      pointsReason.value = '';\r\n      showPointsModal.value = true;\r\n    };\r\n\r\n    const closePointsModal = () => {\r\n      showPointsModal.value = false;\r\n    };\r\n\r\n    const confirmPointsAdjustment = async () => {\r\n      if (!pointsAmount.value) return;\r\n\r\n      try {\r\n        loading.value = true;\r\n\r\n        // Call API to adjust points\r\n        const response = await api.post(`/users/${selectedUser.value._id}/points`, {\r\n          amount: parseFloat(pointsAmount.value),\r\n          reason: pointsReason.value\r\n        });\r\n\r\n        // Update user points in the local state\r\n        const updatedUser = users.value.find(u => u._id === selectedUser.value._id);\r\n        if (updatedUser) {\r\n          updatedUser.points = response.data.points;\r\n        }\r\n\r\n        // Close modal\r\n        closePointsModal();\r\n      } catch (error) {\r\n        console.error('Erreur lors de l\\'ajustement des points:', error);\r\n        alert('Une erreur est survenue lors de l\\'ajustement des points.');\r\n      } finally {\r\n        loading.value = false;\r\n      }\r\n    };\r\n\r\n    const openHistoryModal = (user) => {\r\n      // Rediriger vers la page d'historique avec filtre sur cet utilisateur\r\n      // Cette fonctionnalité pourrait être implémentée plus tard\r\n      console.log('Ouvrir historique pour:', user.email);\r\n    };\r\n\r\n    // Reset page when filters change\r\n    watch([searchTerm, sortBy], () => {\r\n      if (currentPage.value !== 1) {\r\n        currentPage.value = 1;\r\n      }\r\n    });\r\n\r\n    onMounted(() => {\r\n      loadUsers();\r\n    });\r\n\r\n    return {\r\n      users,\r\n      loading,\r\n      searchTerm,\r\n      currentPage,\r\n      totalPages,\r\n      sortBy,\r\n      displayedUsers,\r\n      showPointsModal,\r\n      selectedUser,\r\n      pointsAmount,\r\n      pointsReason,\r\n      defaultAvatar,\r\n      getPhotoUrl,\r\n\r\n      debounceSearch,\r\n      applyFilters,\r\n      changePage,\r\n      formatLastActivity,\r\n      openAddPointsModal,\r\n      closePointsModal,\r\n      confirmPointsAdjustment,\r\n      openHistoryModal\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.points-management-container {\r\n  padding: 20px;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.page-title {\r\n  color: #2c5038;\r\n  margin-bottom: 30px;\r\n  font-size: 2rem;\r\n}\r\n\r\n/* Filtres */\r\n.filters-container {\r\n  display: flex;\r\n  gap: 15px;\r\n  margin-bottom: 20px;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  justify-content: space-between;\r\n}\r\n\r\n.search-box {\r\n  position: relative;\r\n  flex: 1;\r\n  min-width: 200px;\r\n  max-width: 400px;\r\n}\r\n\r\n.search-box input {\r\n  width: 100%;\r\n  padding: 10px 15px 10px 40px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 30px;\r\n  font-size: 1rem;\r\n  outline: none;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.search-box input:focus {\r\n  border-color: #2c5038;\r\n}\r\n\r\n.search-icon {\r\n  position: absolute;\r\n  left: 15px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  color: #666;\r\n}\r\n\r\n.filter-options {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.sort-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.sort-option label {\r\n  font-weight: bold;\r\n  color: #2c5038;\r\n}\r\n\r\n.sort-option select {\r\n  padding: 8px 15px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 5px;\r\n  outline: none;\r\n  background-color: white;\r\n  font-size: 1rem;\r\n}\r\n\r\n/* Tableau des utilisateurs */\r\n.users-table-container {\r\n  overflow-x: auto;\r\n  margin-bottom: 20px;\r\n  background-color: white;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n}\r\n\r\n.users-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.users-table th,\r\n.users-table td {\r\n  padding: 15px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.users-table th {\r\n  background-color: #f8f9fa;\r\n  color: #2c5038;\r\n  font-weight: bold;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 15px;\r\n}\r\n\r\n.user-avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n}\r\n\r\n.user-name {\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.user-email {\r\n  font-size: 0.85rem;\r\n  color: #666;\r\n}\r\n\r\n.points-column {\r\n  font-weight: bold;\r\n}\r\n\r\n.points-badge {\r\n  display: inline-block;\r\n  padding: 5px 10px;\r\n  background-color: #2c5038;\r\n  color: white;\r\n  border-radius: 15px;\r\n  font-size: 0.9rem;\r\n  min-width: 50px;\r\n  text-align: center;\r\n}\r\n\r\n.actions-column {\r\n  display: flex;\r\n  gap: 8px;\r\n}\r\n\r\n.btn {\r\n  padding: 8px 12px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 0.9rem;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 5px;\r\n}\r\n\r\n.view-history {\r\n  background-color: #6c757d;\r\n  color: white;\r\n}\r\n\r\n.edit-points {\r\n  background-color: #2c5038;\r\n  color: white;\r\n}\r\n\r\n/* Pagination */\r\n.pagination {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 20px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.page-btn {\r\n  padding: 8px 16px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  background-color: #2c5038;\r\n  color: white;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.page-btn:disabled {\r\n  background-color: #ccc;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.page-info {\r\n  color: #666;\r\n}\r\n\r\n/* Modal */\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background: white;\r\n  border-radius: 10px;\r\n  width: 90%;\r\n  max-width: 500px;\r\n  overflow: hidden;\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 15px 20px;\r\n  background-color: #2c5038;\r\n  color: white;\r\n}\r\n\r\n.modal-header h2 {\r\n  margin: 0;\r\n  font-size: 1.3rem;\r\n}\r\n\r\n.close-button {\r\n  background: none;\r\n  border: none;\r\n  color: white;\r\n  cursor: pointer;\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.modal-body {\r\n  padding: 20px;\r\n}\r\n\r\n.points-info {\r\n  margin-bottom: 20px;\r\n  padding: 10px;\r\n  background-color: #f8f9fa;\r\n  border-radius: 5px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.form-group input {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 5px;\r\n  font-size: 1rem;\r\n}\r\n\r\n.modal-footer {\r\n  padding: 15px 20px;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 10px;\r\n  background-color: #f8f9fa;\r\n}\r\n\r\n.btn.cancel {\r\n  background-color: #6c757d;\r\n  color: white;\r\n}\r\n\r\n.btn.confirm {\r\n  background-color: #2c5038;\r\n  color: white;\r\n}\r\n\r\n.btn:disabled {\r\n  background-color: #ccc;\r\n  cursor: not-allowed;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .filters-container {\r\n    flex-direction: column;\r\n    align-items: stretch;\r\n  }\r\n\r\n  .search-box {\r\n    max-width: none;\r\n  }\r\n\r\n  .actions-column {\r\n    flex-direction: column;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}