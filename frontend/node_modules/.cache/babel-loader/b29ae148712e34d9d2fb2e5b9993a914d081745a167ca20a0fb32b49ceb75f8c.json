{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport authService from '../services/authService';\nimport { useAuthStore } from '../stores/auth';\nimport api from \"../services/api\";\nexport default {\n  name: 'LoginPage',\n  data() {\n    return {\n      email: '',\n      password: '',\n      loading: false,\n      message: null\n    };\n  },\n  methods: {\n    activerModeVisiteur() {\n      const auth = useAuthStore();\n      auth.setAsVisitor();\n      this.$router.push('/explore');\n    },\n    async handleLogin() {\n      if (this.loading) return;\n      this.loading = true;\n      this.message = null;\n      try {\n        const response = await authService.login(this.email, this.password);\n        const authStore = useAuthStore(); // üî• ICI on initialise Pinia\n\n        this.message = {\n          type: 'success',\n          text: 'Connexion r√©ussie ! Redirection...'\n        };\n\n        // Stockage local\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n\n        // üîê M√†J du store Pinia (indispensable pour ExploreApp.vue)\n        authStore.setAuth(response.user);\n\n        // Ajout de points √† la connexion\n        try {\n          await api.post(`/users/${response.user._id}/points`, {\n            amount: 0.25\n          });\n          authStore.points += 0.25; // met √† jour le store local aussi\n          localStorage.setItem('points', authStore.points);\n        } catch (err) {\n          console.warn(\"Erreur lors de l'ajout de points √† la connexion\", err);\n        }\n        setTimeout(() => {\n          if (response.user.role === 'admin') {\n            this.$router.push('/admin');\n          } else {\n            this.$router.push('/explore');\n          }\n        }, 1500);\n      } catch (error) {\n        console.error('Erreur de connexion :', error);\n        this.message = {\n          type: 'error',\n          text: error.response?.data?.message || \"Erreur inconnue\"\n        };\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["authService","useAuthStore","api","name","data","email","password","loading","message","methods","activerModeVisiteur","auth","setAsVisitor","$router","push","handleLogin","response","login","authStore","type","text","localStorage","setItem","token","JSON","stringify","user","setAuth","post","_id","amount","points","err","console","warn","setTimeout","role","error"],"sources":["C:\\Users\\benab\\Desktop\\COURS 24_25\\S2\\WEB\\V4\\Projet_WEB_ING1\\frontend\\src\\views\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <div class=\"login-image left\">\r\n      <!--<img src=\"@/assets/kitchen-left.jpg\" alt=\"Cuisine design\">-->\r\n    </div>\r\n    <div class=\"login-card\">\r\n      <h2>Bienvenue dans<br>MaCuisineConnect√©e</h2>\r\n      \r\n      <div v-if=\"message\" :class=\"['alert', message.type === 'success' ? 'alert-success' : 'alert-error']\">\r\n        {{ message.text }}\r\n      </div>\r\n\r\n      <form @submit.prevent=\"handleLogin\" class=\"login-form\">\r\n        <div class=\"form-group\">\r\n          <input \r\n            type=\"email\" \r\n            id=\"email\" \r\n            v-model=\"email\" \r\n            required\r\n            placeholder=\"Email\"\r\n            :disabled=\"loading\"\r\n          >\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <input \r\n            type=\"password\" \r\n            id=\"password\" \r\n            v-model=\"password\" \r\n            required\r\n            placeholder=\"Mot de passe\"\r\n            :disabled=\"loading\"\r\n          >\r\n        </div>\r\n\r\n        <button type=\"submit\" :disabled=\"loading\" class=\"submit-btn\">\r\n          <span v-if=\"loading\" class=\"loading-spinner\"></span>\r\n          {{ loading ? 'Connexion en cours...' : 'Se connecter' }}\r\n        </button>\r\n\r\n        <p class=\"register-link\">\r\n          Pas encore de compte ? \r\n          <router-link to=\"/register\" :class=\"{ 'disabled': loading }\">S'inscrire</router-link>\r\n        </p>\r\n        <p class=\"register-link\">\r\n          Espace Visiteurs ‚Äì\r\n          <router-link to=\"/explore\" @click.prevent=\"activerModeVisiteur\">Y acc√©der</router-link>\r\n\r\n        </p>\r\n\r\n      </form>\r\n    </div>\r\n    <div class=\"login-image right\">\r\n      <!--<img src=\"@/assets/kitchen-right.jpg\" alt=\"Plats cuisin√©s\">-->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport authService from '../services/authService';\r\nimport { useAuthStore } from '../stores/auth'\r\nimport api from \"../services/api\";\r\n\r\n\r\nexport default {\r\n  name: 'LoginPage',\r\n  data() {\r\n    return {\r\n      email: '',\r\n      password: '',\r\n      loading: false,\r\n      message: null\r\n    };\r\n  },\r\n  methods: {\r\n\r\n    activerModeVisiteur() {\r\n      const auth = useAuthStore()\r\n      auth.setAsVisitor()\r\n      this.$router.push('/explore')\r\n    },\r\n\r\n\r\n    async handleLogin() {\r\n      if (this.loading) return;\r\n\r\n      this.loading = true;\r\n      this.message = null;\r\n\r\n      try {\r\n        const response = await authService.login(this.email, this.password);\r\n        const authStore = useAuthStore(); // üî• ICI on initialise Pinia\r\n\r\n        this.message = {\r\n          type: 'success',\r\n          text: 'Connexion r√©ussie ! Redirection...'\r\n        };\r\n\r\n        // Stockage local\r\n        localStorage.setItem('token', response.token);\r\n        localStorage.setItem('user', JSON.stringify(response.user));\r\n\r\n        // üîê M√†J du store Pinia (indispensable pour ExploreApp.vue)\r\n        authStore.setAuth(response.user);\r\n\r\n        // Ajout de points √† la connexion\r\n        try {\r\n          await api.post(`/users/${response.user._id}/points`, { amount: 0.25 });\r\n          authStore.points += 0.25; // met √† jour le store local aussi\r\n          localStorage.setItem('points', authStore.points);\r\n        } catch (err) {\r\n          console.warn(\"Erreur lors de l'ajout de points √† la connexion\", err);\r\n        }\r\n\r\n\r\n        setTimeout(() => {\r\n          if (response.user.role === 'admin') {\r\n            this.$router.push('/admin');\r\n          } else {\r\n            this.$router.push('/explore');\r\n          }\r\n        }, 1500);\r\n\r\n      } catch (error) {\r\n        console.error('Erreur de connexion :', error);\r\n        this.message = {\r\n          type: 'error',\r\n          text: error.response?.data?.message || \"Erreur inconnue\"\r\n        };\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    }\r\n\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background-color: #e8f4f8;\r\n  padding: 0;\r\n  gap: 20px;\r\n}\r\n\r\n.login-image {\r\n  height: 85vh;\r\n  width: 200px;\r\n  overflow: hidden;\r\n  display: none;\r\n  border-radius: 30px;\r\n}\r\n\r\n.login-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n  \r\n}\r\n\r\n.login-card {\r\n  background: white;\r\n  padding: 30px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  width: 100%;\r\n  max-width: 400px;\r\n}\r\n\r\nh2 {\r\n  text-align: center;\r\n  color: #006d77;\r\n  margin-bottom: 30px;\r\n  font-size: 1.8rem;\r\n  line-height: 1.3;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  box-sizing: border-box;\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #006d77;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #3aa876;\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: #a8a8a8;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.register-link {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.register-link a {\r\n  color: #42b983;\r\n  text-decoration: none;\r\n}\r\n\r\n.alert {\r\n  padding: 12px;\r\n  border-radius: 4px;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.alert-success {\r\n  background-color: #d4edda;\r\n  color: #155724;\r\n  border: 1px solid #c3e6cb;\r\n}\r\n\r\n.alert-error {\r\n  background-color: #f8d7da;\r\n  color: #721c24;\r\n  border: 1px solid #f5c6cb;\r\n}\r\n\r\n/* Media Queries */\r\n@media screen and (min-width: 1200px) {\r\n  .login-image {\r\n    display: block;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .login-container {\r\n    padding: 15px;\r\n  }\r\n  .login-card {\r\n    padding: 25px;\r\n  }\r\n  h2 {\r\n    font-size: 1.75rem;\r\n    margin-bottom: 25px;\r\n  }\r\n  input {\r\n    padding: 10px;\r\n    font-size: 14px;\r\n  }\r\n  button {\r\n    padding: 10px;\r\n    font-size: 14px;\r\n  }\r\n}\r\n@media screen and (max-width: 480px) {\r\n  .login-container {\r\n    padding: 10px;\r\n  }\r\n  .login-card {\r\n    padding: 20px;\r\n  }\r\n  h2 {\r\n    font-size: 1.5rem;\r\n    margin-bottom: 20px;\r\n  }\r\n  .form-group {\r\n    margin-bottom: 15px;\r\n  }\r\n  label {\r\n    font-size: 0.9rem;\r\n  }\r\n  input {\r\n    padding: 8px;\r\n    font-size: 13px;\r\n  }\r\n  button {\r\n    padding: 8px;\r\n    font-size: 13px;\r\n  }\r\n  .register-link {\r\n    font-size: 0.8rem;\r\n  }\r\n  .alert {\r\n    padding: 10px;\r\n    font-size: 0.8rem;\r\n  }\r\n}\r\n\r\n.submit-btn {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 8px;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 16px;\r\n  height: 16px;\r\n  border: 2px solid #ffffff;\r\n  border-top: 2px solid transparent;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.disabled {\r\n  pointer-events: none;\r\n  opacity: 0.7;\r\n}\r\n\r\ninput:disabled {\r\n  background-color: #f5f5f5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.alert {\r\n  animation: slideDown 0.3s ease-out;\r\n}\r\n\r\n@keyframes slideDown {\r\n  from {\r\n    transform: translateY(-10px);\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    transform: translateY(0);\r\n    opacity: 1;\r\n  }\r\n}\r\n</style> "],"mappings":";AA2DA,OAAOA,WAAU,MAAO,yBAAyB;AACjD,SAASC,YAAW,QAAS,gBAAe;AAC5C,OAAOC,GAAE,MAAO,iBAAiB;AAGjC,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,OAAO,EAAE,KAAK;MACdC,OAAO,EAAE;IACX,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IAEPC,mBAAmBA,CAAA,EAAG;MACpB,MAAMC,IAAG,GAAIV,YAAY,CAAC;MAC1BU,IAAI,CAACC,YAAY,CAAC;MAClB,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,UAAU;IAC9B,CAAC;IAGD,MAAMC,WAAWA,CAAA,EAAG;MAClB,IAAI,IAAI,CAACR,OAAO,EAAE;MAElB,IAAI,CAACA,OAAM,GAAI,IAAI;MACnB,IAAI,CAACC,OAAM,GAAI,IAAI;MAEnB,IAAI;QACF,MAAMQ,QAAO,GAAI,MAAMhB,WAAW,CAACiB,KAAK,CAAC,IAAI,CAACZ,KAAK,EAAE,IAAI,CAACC,QAAQ,CAAC;QACnE,MAAMY,SAAQ,GAAIjB,YAAY,CAAC,CAAC,EAAE;;QAElC,IAAI,CAACO,OAAM,GAAI;UACbW,IAAI,EAAE,SAAS;UACfC,IAAI,EAAE;QACR,CAAC;;QAED;QACAC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEN,QAAQ,CAACO,KAAK,CAAC;QAC7CF,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEE,IAAI,CAACC,SAAS,CAACT,QAAQ,CAACU,IAAI,CAAC,CAAC;;QAE3D;QACAR,SAAS,CAACS,OAAO,CAACX,QAAQ,CAACU,IAAI,CAAC;;QAEhC;QACA,IAAI;UACF,MAAMxB,GAAG,CAAC0B,IAAI,CAAC,UAAUZ,QAAQ,CAACU,IAAI,CAACG,GAAG,SAAS,EAAE;YAAEC,MAAM,EAAE;UAAK,CAAC,CAAC;UACtEZ,SAAS,CAACa,MAAK,IAAK,IAAI,EAAE;UAC1BV,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEJ,SAAS,CAACa,MAAM,CAAC;QAClD,EAAE,OAAOC,GAAG,EAAE;UACZC,OAAO,CAACC,IAAI,CAAC,iDAAiD,EAAEF,GAAG,CAAC;QACtE;QAGAG,UAAU,CAAC,MAAM;UACf,IAAInB,QAAQ,CAACU,IAAI,CAACU,IAAG,KAAM,OAAO,EAAE;YAClC,IAAI,CAACvB,OAAO,CAACC,IAAI,CAAC,QAAQ,CAAC;UAC7B,OAAO;YACL,IAAI,CAACD,OAAO,CAACC,IAAI,CAAC,UAAU,CAAC;UAC/B;QACF,CAAC,EAAE,IAAI,CAAC;MAEV,EAAE,OAAOuB,KAAK,EAAE;QACdJ,OAAO,CAACI,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAC7C,IAAI,CAAC7B,OAAM,GAAI;UACbW,IAAI,EAAE,OAAO;UACbC,IAAI,EAAEiB,KAAK,CAACrB,QAAQ,EAAEZ,IAAI,EAAEI,OAAM,IAAK;QACzC,CAAC;MACH,UAAU;QACR,IAAI,CAACD,OAAM,GAAI,KAAK;MACtB;IACF;EAEF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}